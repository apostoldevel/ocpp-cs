(this["webpackJsonpocpp-cs"]=this["webpackJsonpocpp-cs"]||[]).push([[9],{1119:function(e,t,s){"use strict";s.r(t);var a=s(0),i=s.n(a),n=s(100),o=s(41),r=s(172),c=s(2),l=s(763),d=s(602),h=s(681),p=s(102),g=s(669),m=s(90),u=s(154),j=s(638),b=s(635),x=s(22),f=s(389),v=s(653),O=s(654),y=s(693),w=s(127),S=s(128),C=s(631),I=s(719),L=s(633),k=s(3);L.a.tick();class P extends i.a.Component{constructor(e){var t;super(e),t=this,this.m=function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"stations.";const{intl:a}=t.props;return a.formatMessage({id:s+e})},this.pendingStart=()=>{this.props.onPendingStart?this.props.onPendingStart():this.setState({pending:!0})},this.pendingEnd=()=>{this.props.onPendingEnd?this.props.onPendingEnd():this.setState({pending:!1})},this.load=async()=>{if(this.props.stationId){this.pendingStart();let e=[await this.context.api.q("/charge_point/get",{id:this.props.stationId}),await this.context.api.q("/object/access/decode",{id:this.props.stationId}),await this.context.api.q("/object/file",{id:this.props.stationId},{toArray:!0})],[t,s,a]=(await Promise.allSettled(e)).map(e=>e.value);this.setState({item:t,access:s,files:a},()=>this.pendingEnd())}else this.setState({item:{},access:{},files:[]})},this.chargeToggle=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=arguments.length>1?arguments[1]:void 0;if(e.id){t.setState({detailPending:!0});let a=!1;a=s?await t.context.api.q("/connector/remote/stop",{id:e.id}):await t.context.api.q("/connector/remote/start",{id:e.id}),t.setState({detailPending:!1}),!1===a?f.b.error(t.m("method.fail","")):f.b.success(t.m("method.success","")),await t.load()}},this.reserveToggle=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=arguments.length>1?arguments[1]:void 0;if(e.id){t.setState({detailPending:!0});let a=!1;a=s?await t.context.api.q("/connector/reserve/cancel",{id:e.id}):await t.context.api.q("/connector/reserve/now",{id:e.id}),t.setState({detailPending:!1}),!1===a?f.b.error(t.m("method.fail","")):f.b.success(t.m("method.success","")),await t.load()}},this.state={detailPending:!1,pending:!1,stationId:!1,item:{},access:{},files:[]}}componentDidMount(){this.load()}componentDidUpdate(e,t,s){e.stationId===this.props.stationId&&e.intl.locale===this.props.intl.locale||this.setState({item:{}},()=>this.load())}render(){const{pending:e,item:t,access:s,files:a}=this.state,i=t.connectors||[],n=e=>{let{item:t,property:s,connected:a}=e,i=null===t||void 0===t?void 0:t[s];return"string"===typeof i?"lastupdate"!==s&&"created"!==s&&"connectionupdate"!==s||(i=new Date(i).toLocaleString()):"boolean"===typeof i&&(i=i?this.m("true"):this.m("false")),i?Object(k.jsxs)(v.a,{gutter:[16,16],className:"gx-mb-2",children:[Object(k.jsx)(O.a,{className:"gx-text-muted gx-font-weight-light gx-pr-2",xs:10,children:"connectionupdate"===s?a?this.m(s):this.m("disconnected"):this.m(s)}),Object(k.jsx)(O.a,{xs:14,children:i})]}):null};return Object(k.jsx)("div",{children:Object(k.jsxs)(y.a,{spinning:e,children:[!(null!==t&&void 0!==t&&t.id)&&Object(k.jsx)(l.a,{}),(null===t||void 0===t?void 0:t.id)&&Object(k.jsxs)("div",{className:"gx-mb-3",children:[(null===t||void 0===t?void 0:t.description)&&Object(k.jsx)("div",{className:"gx-text-muted gx-font-weight-light gx-mb-3",children:t.description}),Object(k.jsxs)(S.a,{between:!0,className:"gx-mb-3 gx-pr-1",children:[Object(k.jsx)("h4",{children:this.m("details")}),Object(k.jsx)(C.a,Object(c.a)(Object(c.a)({},t),{},{readOnly:!(null!==s&&void 0!==s&&s.u),onFinish:this.load}))]}),["identity","modelname","vendorname","serialnumber","boxserialnumber","iccid","imsi","networkname","connected","connectionupdate","lastupdate"].map(e=>Object(k.jsx)(n,{item:t,property:e,connected:t.connected},e)),i.length>0&&Object(k.jsx)(k.Fragment,{children:Object(k.jsxs)(y.a,{spinning:this.state.detailPending,children:[Object(k.jsx)("hr",{}),i.map((e,t)=>Object(k.jsx)("div",{className:"gx-mb-2",children:Object(k.jsxs)(S.a,{between:!0,children:[Object(k.jsxs)("div",{children:[e.chargername,Object(k.jsx)("div",{className:"gx-font-weight-light gx-text-small gx-text-muted",children:e.chargerdescription})]}),Object(k.jsxs)("div",{className:"gx-ml-2 gx-mr-1",children:[Object(k.jsx)(C.a,Object(c.a)(Object(c.a)({},e),{},{readOnly:!0,onFinish:this.load})),Object(k.jsx)("div",{style:{whiteSpace:"nowrap"},children:Object(k.jsx)(I.a,Object(c.a)(Object(c.a)({m:this.m},e),{},{chargeToggle:t=>this.chargeToggle(e,t),reserveToggle:t=>this.reserveToggle(e,t)}))})]})]})},t))]})}),(null===s||void 0===s?void 0:s.u)&&Object(k.jsx)(x.a,{to:"/crm/station/".concat(t.id),children:Object(k.jsx)(w.a,{className:"gx-mb-0 gx-mt-4",children:this.m("edit","")})}),a.length>0&&Object(k.jsxs)(k.Fragment,{children:[Object(k.jsx)("hr",{}),a.map((e,t)=>Object(k.jsx)("img",{alt:"",src:e.link},t))]})]})]})})}}P.contextType=n.a;var E=Object(o.i)(Object(r.c)(P));class M extends i.a.Component{constructor(e){var t;super(e),t=this,this.getYandexLanguage=e=>({ru:"ru_RU",en:"en_US",de:"de_DE",fr:"fr_FR",it:"it_IT"}[e]||e.toUpperCase()),this.getMapLanguage=e=>{const t=localStorage.getItem("ocppcsDefaultLanguage"),s=e.mapLanguage||e.defaultLanguage;return this.getYandexLanguage(t||s)},this.pendingStart=()=>{this.props.onPendingStart?this.props.onPendingStart():this.setState({pending:!0})},this.pendingEnd=()=>{this.props.onPendingEnd?this.props.onPendingEnd():this.setState({pending:!1})},this.m=function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"stations.map.";const{intl:a}=t.props;return a.formatMessage({id:s+e})},this.setParams=()=>{const{param1:e,param2:t}=this.props.match.params;this.setState({carId:e,chargerId:t},()=>this.load())},this.load=async()=>{this.pendingStart();let e=[];this.state.chargerId&&e.push({field:"connectors",compare:"GIN",value:[{charger:this.state.chargerId}]});let t=await this.context.api.q("/charge_point/list",{search:e},{toArray:!0});this.setState({stations:t},()=>this.pendingEnd())},this.getItemGeo=e=>{var t;let s=(null===e||void 0===e||null===(t=e.geo)||void 0===t?void 0:t[0])||{},a=s.latitude,i=s.longitude;return a&&i?[a,i]:null},this.drawerClose=()=>{this.setState({drawerVisible:!1})},this.onPlacemarkClick=e=>{this.setState({drawerItem:e,drawerVisible:!0})};const s=window.appConfig||{};this.config=Object(c.a)(Object(c.a)({},s),{},{yandexMapsApiKey:"d6d977d2-451a-419f-ab59-861fb43d17a5",mapLanguage:this.getMapLanguage(s),mapDefaultCenter:s.mapDefaultCenter||[50.85045,4.34878]}),this.state={mapLoaded:!1,pending:!1,stations:[],carId:!1,chargerId:!1,drawerVisible:!1,drawerItem:{}}}componentDidMount(){this.setParams(),this.load()}componentDidUpdate(e,t,s){Object(j.a)(e,this.props)&&this.setParams(),e.intl.locale!==this.props.intl.locale&&this.load()}render(){const{stations:e,mapLoaded:t,pending:s,drawerItem:a}=this.state;if(!Array.isArray(e))return null;if(0===e.length)return Object(k.jsx)(l.a,{});const n=e.map(e=>this.getItemGeo(e)).filter(e=>e);if(0===n.length)return Object(k.jsx)("div",{className:this.props.className,children:Object(k.jsx)(l.a,{})});const o=i.a.createRef(),r=this.getMapLanguage(this.config),c=this.config.yandexMapsApiKey,j=this.config.mapDefaultCenter;return Object(k.jsxs)(k.Fragment,{children:[(!t||s)&&Object(k.jsx)(m.a,{}),Object(k.jsx)(d.a,{title:null===a||void 0===a?void 0:a.label,placement:"right",onClose:this.drawerClose,visible:this.state.drawerVisible,children:Object(k.jsx)(u.a,{children:Object(k.jsx)(E,{stationId:null===a||void 0===a?void 0:a.id})})}),Object(k.jsx)(p.a,{children:Object(k.jsx)("title",{children:this.m("stations")})}),Object(k.jsxs)("div",{className:"gx-st-map huge",style:{visibility:t&&!s?"visible":"hidden"},children:[Object(k.jsx)("div",{className:"filterbox",children:Object(k.jsx)(h.a,{size:"small",children:Object(k.jsx)(b.a,{value:this.state.carId,placeholder:this.m("forcar"),formatLabel:e=>"".concat(e.label," ").concat(e.identity),extraFields:["identity","chargerac"],enabledOnly:!0,labelKey:"label",query:"/car/list",onChange:(e,t)=>{this.props.history.push("/driver/stations/".concat(e,"/").concat(t.chargerac||""))}})})}),Object(k.jsx)(g.c,{query:{apikey:c,lang:r},children:Object(k.jsxs)(g.a,{defaultState:{center:n[0]||j,zoom:9},width:"100%",height:"100%",modules:["geoObject.addon.balloon","util.bounds"],onLoad:e=>{this.setState({mapLoaded:!0}),n.length>1&&o.current.setBounds(e.util.bounds.fromPoints(n))},instanceRef:e=>{e&&(o.current=e)},children:[0!==e.length?e.map((e,t)=>{let s=this.getItemGeo(e);if(!s)return null;let a=[];return e.description&&a.push("<div>".concat(e.description||"","</div>")),e.modelname&&a.push("<div>".concat(e.modelname||""," ").concat(e.vendorname||"","</div>")),Object(k.jsx)(g.b,{defaultGeometry:s,onClick:()=>this.onPlacemarkClick(e),options:{iconLayout:"default#image",iconImageHref:e.connected?"/assets/images/flash-green.png":"/assets/images/flash-red.png",iconImageSize:[32,32]}},t)}):[],Object(k.jsx)(g.d,{})]})},r)]})]})}}M.contextType=n.a;var N=Object(o.i)(Object(r.c)(M)),D=s(670);const K={width:"100%",height:"100%"},T={lat:50.85045,lng:4.34878},F="/assets/images/flash-green.png",A={width:32,height:32};class R extends i.a.Component{constructor(e){var t;super(e),t=this,this.pendingStart=()=>{this.props.onPendingStart?this.props.onPendingStart():this.setState({pending:!0})},this.pendingEnd=()=>{this.props.onPendingEnd?this.props.onPendingEnd():this.setState({pending:!1})},this.m=function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"stations.map.";const{intl:a}=t.props;return a.formatMessage({id:s+e})},this.startLanguagePolling=()=>{this.languageCheckInterval=setInterval(()=>{this.checkLanguageChange()},1e3)},this.checkLanguageChange=()=>{const e=localStorage.getItem("ocppcsDefaultLanguage"),t=window.appConfig||{},s=t.mapLanguage||t.defaultLanguage,a=e||s;a!==this.state.currentLanguage&&this.handleLanguageChange(a)},this.handleLanguageChange=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;const s=localStorage.getItem("ocppcsDefaultLanguage"),a=window.appConfig||{},i=a.mapLanguage||a.defaultLanguage,n=e||s||i;n!==t.state.currentLanguage&&(t.setState({currentLanguage:n,googleMapsReady:!1,mapLoaded:!1}),t.config.mapLanguage=n)},this.setParams=()=>{const{param1:e,param2:t}=this.props.match.params;this.setState({carId:e,chargerId:t},()=>this.load())},this.load=async()=>{this.pendingStart();let e=[];this.state.chargerId&&e.push({field:"connectors",compare:"GIN",value:[{charger:this.state.chargerId}]});let t=await this.context.api.q("/charge_point/list",{search:e},{toArray:!0});this.setState({stations:t},()=>this.pendingEnd())},this.getItemGeo=e=>{var t;let s=(null===e||void 0===e||null===(t=e.geo)||void 0===t?void 0:t[0])||{},a=s.latitude,i=s.longitude;return a&&i?{lat:parseFloat(a),lng:parseFloat(i)}:null},this.drawerClose=()=>{this.setState({drawerVisible:!1})},this.onMarkerClick=e=>{this.setState({drawerItem:e,drawerVisible:!0})},this.createMarkerIcon=()=>{window.google&&window.google.maps&&window.google.maps.Size&&(this.markerIcon={url:F,scaledSize:new window.google.maps.Size(A.width,A.height)})},this.fitBounds=(e,t)=>{if(!window.google||!window.google.maps||!window.google.maps.LatLngBounds)return void console.warn("Google Maps API not yet loaded");if(0===t.length)return;if(1===t.length)return e.setCenter(t[0]),void e.setZoom(12);const s=new window.google.maps.LatLngBounds;t.forEach(e=>{s.extend(e)}),e.fitBounds(s)},this.onMapLoad=e=>{this.setState({mapLoaded:!0,map:e});const{stations:t}=this.state,s=t.map(e=>this.getItemGeo(e)).filter(e=>e);s.length>0&&setTimeout(()=>{e&&window.google&&window.google.maps&&this.fitBounds(e,s)},1e3)},this.onScriptLoad=()=>{this.setState({googleMapsReady:!0,loadError:null}),this.createMarkerIcon()},this.onScriptError=e=>{console.error("\u274c Error loading Google Maps script:",e),this.setState({googleMapsReady:!0,loadError:e})},this.getRegionFromLanguage=e=>({ru:"RU",en:"US",de:"DE",fr:"FR",es:"ES",zh:"CN",ja:"JP",ko:"KR"}[e]||e.toUpperCase());const s=window.appConfig||{},a=localStorage.getItem("ocppcsDefaultLanguage"),i=s.mapLanguage||s.defaultLanguage;let n=a||i;this.config=Object(c.a)(Object(c.a)({},s),{},{googleMapsApiKey:"AIzaSyDywgsfSKKfn0GBD91K9X6vawEv4D1Seak",mapLanguage:n}),this.state={mapLoaded:!1,googleMapsReady:!1,loadError:null,pending:!1,stations:[],map:null,carId:!1,chargerId:!1,drawerVisible:!1,drawerItem:{},currentLanguage:n},this.markerIcon=null}componentDidMount(){this.setParams(),this.load(),this.startLanguagePolling()}componentDidUpdate(e,t){Object(j.a)(e,this.props)&&this.setParams(),e.intl.locale!==this.props.intl.locale&&this.handleLanguageChange(),!this.state.googleMapsReady||t.googleMapsReady||this.markerIcon||this.createMarkerIcon()}componentWillUnmount(){this.languageCheckInterval&&clearInterval(this.languageCheckInterval)}renderMapContent(){const{stations:e,googleMapsReady:t}=this.state;return t?Object(k.jsx)(k.Fragment,{children:e.map((e,t)=>{const s=this.getItemGeo(e);return s?Object(k.jsx)(D.d,{position:s,onClick:()=>this.onMarkerClick(e),icon:this.markerIcon},t):null})}):null}render(){const{stations:e,mapLoaded:t,pending:s,drawerItem:a,googleMapsReady:i,currentLanguage:n}=this.state;if(!Array.isArray(e))return null;if(0===e.length)return Object(k.jsx)(l.a,{});const o=e.map(e=>this.getItemGeo(e)).filter(e=>e);if(0===o.length)return Object(k.jsx)("div",{className:this.props.className,children:Object(k.jsx)(l.a,{})});const r=o.length>0?o[0]:T;return Object(k.jsxs)(k.Fragment,{children:[(!t||s||!i)&&Object(k.jsx)(m.a,{}),Object(k.jsx)(d.a,{title:null===a||void 0===a?void 0:a.label,placement:"right",onClose:this.drawerClose,visible:this.state.drawerVisible,children:Object(k.jsx)(u.a,{children:Object(k.jsx)(E,{stationId:null===a||void 0===a?void 0:a.id})})}),Object(k.jsx)(p.a,{children:Object(k.jsx)("title",{children:this.m("stations")})}),Object(k.jsxs)("div",{className:"gx-st-map huge",style:{opacity:t&&!s&&i?1:0,transition:"opacity 0.3s"},children:[Object(k.jsx)("div",{className:"filterbox",children:Object(k.jsx)(h.a,{size:"small",children:Object(k.jsx)(b.a,{value:this.state.carId,placeholder:this.m("forcar"),formatLabel:e=>"".concat(e.label," ").concat(e.identity),extraFields:["identity","chargerac"],enabledOnly:!0,labelKey:"label",query:"/car/list",onChange:(e,t)=>{this.props.history.push("/driver/stations/".concat(e,"/").concat(t.chargerac||""))}})})}),Object(k.jsx)(D.c,{googleMapsApiKey:this.config.googleMapsApiKey,language:n,region:this.getRegionFromLanguage(n),loadingElement:Object(k.jsx)("div",{style:{height:"100%",background:"#f0f0f0"}}),onLoad:this.onScriptLoad,onError:this.onScriptError,children:Object(k.jsx)(D.a,{mapContainerStyle:K,center:r,zoom:9,onLoad:this.onMapLoad,options:{zoomControl:!0,streetViewControl:!1,mapTypeControl:!1,fullscreenControl:!0,language:n},children:this.renderMapContent()})})]})]})}}R.contextType=n.a;var q=Object(o.i)(Object(r.c)(R));class G extends i.a.Component{constructor(e){super(e);const t=window.appConfig||{};this.config={map:t.map}}render(){return Object(k.jsx)(k.Fragment,{children:"yandex"===this.config.map?Object(k.jsx)(N,{}):Object(k.jsx)(q,{})})}}G.contextType=n.a;t.default=Object(o.i)(Object(r.c)(G))},631:function(e,t,s){"use strict";var a=s(601),i=s(389),n=s(632),o=s(261),r=s(693),c=s(172),l=s(0),d=s.n(l),h=s(100),p=s(136),g=s(633),m=s(3);const{confirm:u}=a.a;class j extends d.a.Component{constructor(e){super(e),this.popoverToggle=()=>{this.setState(e=>({popoverOpen:!e.popoverOpen,methods:e.popoverOpen?e.methods:[]}),()=>this.load())},this.pendingStart=()=>{this.props.onPendingStart?this.props.onPendingStart():this.setState({pending:!0})},this.pendingEnd=()=>{this.props.onPendingEnd?this.props.onPendingEnd():this.setState({pending:!1})},this.load=async()=>{if(this.state.popoverOpen){this.pendingStart();let e=await this.context.api.q("/".concat(this.props.classcode,"/method"),{id:this.props.id},{toArray:!0});this.setState({methods:e},()=>this.pendingEnd())}},this.run=async e=>{this.pendingStart();let t=await this.context.api.q("/method/run",{id:this.props.id,method:e.id});this.pendingEnd(),this.popoverToggle(),t?(i.b.success(this.m("method.success")),this.props.onFinish&&this.props.onFinish(e)):(i.b.error(this.m("method.fail")),this.setState({pending:!1}))},this.ask=async e=>{"drop"===e.actioncode?u({title:this.m("method.confirm.title"),content:this.m("method.confirm.text"),icon:Object(m.jsx)(p.a,{}),onOk:()=>{this.run(e)}}):this.run(e)},this.m=e=>{const{intl:t}=this.props;return t.formatMessage({id:e})},this.state={popoverOpen:!1,methods:[]}}render(){var e;if(null===(e=this.props)||void 0===e||!e.statelabel)return null;const{pending:t,methods:s=[]}=this.state,a=Object(m.jsx)(n.a,{className:"gx-m-0",color:{created:"processing",enabled:"success",disabled:"default",deleted:"error"}[this.props.statetypecode],children:this.props.statelabel});return this.props.readOnly?a:Object(m.jsx)(o.a,{content:Object(m.jsx)("div",{className:"".concat(0===s.length&&"gx-p-3"),children:Object(m.jsx)(r.a,{spinning:t,children:s.map(e=>e.visible?Object(m.jsx)("div",{onClick:()=>this.ask(e),className:"gx-my-2 gx-pointer gx-link",children:e.label},e.id):null)})}),trigger:"click",open:this.state.popoverOpen,onOpenChange:this.popoverToggle,children:Object(m.jsx)("div",{className:"gx-pointer",children:a})})}}j.contextType=h.a;t.a=Object(g.b)(Object(c.c)(j),{statelabel:e=>e.statenewlabel,statetypecode:e=>e.statenewtypecode})},633:function(e,t,s){"use strict";s.d(t,"a",function(){return l}),s.d(t,"b",function(){return d});var a=s(2),i=s(0),n=s.n(i),o=s(35),r=s(141),c=s(3);const l={is:!1,tick:()=>{l.fetch()},goOffline:()=>{l.is&&(l.is=!1,l.dispatch("onlineGoOffline"),l.log("Went offline"))},goOnline:()=>{l.is||(l.is=!0,l.dispatch("onlineGoOnline"),l.log("Back On Line"))},dispatch:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};window.dispatchEvent(new CustomEvent(e,{detail:t}))},fetch:async()=>{let e=r.a.get();if(e){let n=new Date;n.setMilliseconds(n.getMilliseconds()-(o.a.apiCheckInterval+5e3));const r=JSON.stringify({search:[{field:"datetime",value:n,compare:"GEQ"}],reclimit:500,orderby:["datetime DESC"]});let c=null,d=null,h=new Headers;h.append("Content-Type","application/json"),h.append("Authorization","Bearer ".concat(e));const p="".concat(o.a.apiDomain).concat(o.a.apiPath,"/notification/list");try{var t,s,a;if(d=await fetch(p,{method:"POST",headers:h,body:r,mode:"cors",cache:"no-store"}),d)if(c=await d.json(),null!==(t=c)&&void 0!==t&&t.error)return l.error(null===(s=c)||void 0===s||null===(a=s.error)||void 0===a?void 0:a.message);l.goOnline()}catch(i){return l.goOffline(),l.error(i.message)}if(c){let e={};(Array.isArray(c)?c:[c]).forEach(t=>{e[t.object]||(e[t.object]=t)});let t=Object.keys(e).length;t>0&&(l.dispatch("onlineChanged",{items:e}),l.log("messages count "+t))}return!1}},error:e=>(o.a.debug&&console.log('%c OnLine: ERROR "'.concat(e,'"'),"color: orange"),!1),log:e=>{o.a.debug&&console.log("%c OnLine: ".concat(e),"color: cyan")}};function d(e,t){const s=Object.keys(t);return class extends n.a.Component{constructor(e){super(e),this.onOnlineChanged=e=>{var a;let i=null===e||void 0===e||null===(a=e.detail)||void 0===a?void 0:a.items[this.props.id];i&&(this.setState(e=>{let{passProps:a}=e;return s.forEach(e=>{a[e]=t[e](i)}),{passProps:a}}),this.setState({data:i}))},this.state={data:{},passProps:{}}}componentDidMount(){window.addEventListener("onlineChanged",this.onOnlineChanged)}componentWillUnmount(){window.removeEventListener("onlineChanged",this.onOnlineChanged)}componentDidUpdate(e,t,a){let{passProps:i}=this.state,n=!1;s.forEach(t=>{e[t]!==this.props[t]&&(i[t]=this.props[t],n=!0)}),n&&this.setState({passProps:i})}render(){const{passProps:t}=this.state;return Object(c.jsx)(e,Object(a.a)(Object(a.a)({},this.props),t))}}}!window.onlineInterval&&o.a.apiCheckInterval&&window.setInterval(()=>l.tick(),o.a.apiCheckInterval)},635:function(e,t,s){"use strict";var a=s(0),i=s.n(a),n=s(172),o=s(717),r=s(100),c=s(3);const{Option:l}=o.a;class d extends i.a.Component{constructor(e){super(e),this.createSearch=()=>{let e=this.props.search||[];return this.state.searchText&&this.props.async&&e.push({field:this.props.labelKey||"label",compare:"IKE",value:"%".concat(this.state.searchText,"%")}),this.props.enabledOnly&&e.push({field:"statetypecode",compare:"EQL",value:"enabled"}),this.props.client&&e.push({field:"client",value:this.props.client}),e},this.getLabelKey=()=>this.props.labelKey||"label",this.getIdKey=()=>this.props.valueKey||"id",this.shureHaveValue=async()=>{if(this.props.async&&!this.state.items.find(e=>e[this.getIdKey()]===this.props.value)){this.setState({pending:!0});let e=await this.context.api.q("/object/get",{id:this.props.value,fields:[this.getIdKey(),this.getLabelKey()]});this.setState({pending:!1}),null!==e&&void 0!==e&&e[this.getLabelKey()]&&this.setState(t=>{let{items:s}=t;return s.push(e),{items:s}})}},this.load=async()=>{if(this.props.items)return void this.setState({items:this.props.items});let e=[],t=this.props.async?1:0;if(this.props.query){this.setState({pending:!0});let s=this.createSearch(),a=[this.getIdKey(),this.getLabelKey()].concat(this.props.extraFields||[]),i=this.props.cache?this.context.api.cache:this.context.api.q;e=await i(this.props.query,{search:s,reclimit:t,fields:a},{toArray:!0}),this.setState({pending:!1,items:e})}},this.onSearch=async e=>{this.props.async&&this.setState({searchText:e},()=>this.load())},this.onChange=e=>{let t=this.state.items.find(t=>t[this.getIdKey()]===e);this.props.onChange(e,t)},this.state={searchText:"",pending:!1,items:[]}}componentDidMount(){this.load().then(this.shureHaveValue())}componentDidUpdate(e,t,s){e.value!==this.props.value&&this.shureHaveValue()}render(){let e=this.state.items.map((e,t)=>{let s=e||{},a=s[this.getIdKey()],i=this.props.formatLabel?this.props.formatLabel(e):s[this.getLabelKey()];return Object(c.jsx)(l,{value:a,children:i},t)});return Object(c.jsx)(o.a,{defaultActiveFirstOption:!1,allowClear:this.props.allowClear,loading:!!this.state.pending,value:this.state.pending?null:this.props.value,showSearch:!0,placeholder:this.props.placeholder,optionFilterProp:"children",onChange:this.onChange,onSearch:this.onSearch,filterOption:(e,t)=>t.children.toLowerCase().indexOf(e.toLowerCase())>=0,children:e})}}d.contextType=r.a,t.a=Object(n.c)(d)},638:function(e,t,s){"use strict";function a(e,t){const s=e.match.params||{},a=t.match.params||{};return s.param1!==a.param1||s.param2!==a.param2||s.param3!==a.param3}s.d(t,"a",function(){return a})},719:function(e,t,s){"use strict";var a=s(615),i=s(1096),n=s(142),o=s(127),r=s(0),c=s.n(r),l=s(633),d=s(3);t.a=Object(l.b)(function(e){let t=["charging"].includes(e.statecode),s=["reserved"].includes(e.statecode);return Object(d.jsxs)(c.a.Fragment,{children:[Object(d.jsx)(n.a,{title:e.m("btn.charge"),children:Object(d.jsx)(o.a,{className:"gx-mr-1",onClick:s=>{s.stopPropagation(),e.chargeToggle(t)},icon:Object(d.jsx)(a.a,{className:"".concat(t?"gx-text-warning":"")})})}),Object(d.jsx)(n.a,{title:e.m("btn.reserve"),children:Object(d.jsx)(o.a,{onClick:t=>{t.stopPropagation(),e.reserveToggle(s)},icon:Object(d.jsx)(i.a,{className:"".concat(s?"gx-text-warning":"")})})})]})},{statecode:e=>e.statenewcode})}}]);
//# sourceMappingURL=9.2b824dd4.chunk.js.map