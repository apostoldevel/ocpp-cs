(this["webpackJsonpocpp-cs"]=this["webpackJsonpocpp-cs"]||[]).push([[26],{1107:function(t,e,s){"use strict";s.r(e);var i=s(2),n=s(0),a=s.n(n),o=s(127),r=s(637),c=s(271),l=s(172),h=s(100),p=s(627),d=s(628),u=s(629),m=s(631),g=s(641),f=s(760),b=s(3);class v extends a.a.Component{constructor(t){var e;super(t),e=this,this.m=function(t){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"admin.reference.";const{intl:i}=e.props;return i.formatMessage({id:s+t})},this.onMethodFinish=()=>{this.setState({tableUuid:Object(p.a)()}),this.props.onMethodFinish&&this.props.onMethodFinish()},this.editModalToggle=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;e.setState(e=>({editModalVisible:!e.editModalVisible,editModalId:t}))},this.editModalFinish=()=>{this.editModalToggle(),this.onMethodFinish()},this.setColumns=()=>{this.setState({columns:[{text:!0,title:Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)(o.a,{className:"gx-mr-4",onClick:t=>{t.stopPropagation(),this.editModalToggle()},icon:Object(b.jsx)(r.a,{})}),this.m("name")]}),dataIndex:"name",sorter:!0,render:(t,e)=>Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)("div",{children:Object(b.jsx)("div",{className:"gx-pointer gx-text-primary",onClick:()=>this.editModalToggle(e.id),children:Object(b.jsx)(b.Fragment,{children:t})})}),e.description&&Object(b.jsx)("div",{className:"gx-font-weight-light gx-text-muted",children:e.description})]}),filterDropdown:t=>Object(b.jsx)(u.a,Object(i.a)({},t)),filterIcon:t=>Object(b.jsx)(c.a,{style:{color:t?"#1890ff":void 0}})},{title:this.m("typename"),dataIndex:"typename",sorter:!0,width:"25%",render:(t,e)=>Object(b.jsx)(b.Fragment,{children:Object(b.jsx)("div",{children:t})})},{title:this.m("statename"),dataIndex:"statename",sorter:!0,width:"10%",render:(t,e)=>Object(b.jsx)("div",{className:"gx-text-right",children:Object(b.jsx)(m.a,Object(i.a)({onFinish:this.onMethodFinish},e))})}]})},this.state={tableUuid:Object(p.a)(),columns:[],editModalVisible:!1,editModalId:null}}componentDidMount(){this.setColumns()}componentDidUpdate(t,e,s){t.intl.locale!==this.props.intl.locale&&this.setColumns()}render(){return Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)(g.a,{essence:"network",onClose:this.editModalToggle,form:f.a.call(this,{essence:"network"}),onFinish:this.editModalFinish,visible:this.state.editModalVisible,id:this.state.editModalId}),Object(b.jsx)(d.a,{uuid:this.state.tableUuid,columns:this.state.columns,path:"/network/list"})]})}}v.contextType=h.a,e.default=Object(l.c)(v)},627:function(t,e,s){"use strict";function i(){return"f".concat((+new Date).toString(16)).concat((t=1e3,e=9999,t=Math.ceil(t),e=Math.floor(e),Math.floor(Math.random()*(e-t+1))+t));var t,e}s.d(e,"a",function(){return i})},628:function(t,e,s){"use strict";s.d(e,"a",function(){return l});var i=s(2),n=s(0),a=s.n(n),o=s(100),r=s(1113),c=s(3);class l extends a.a.Component{constructor(t){var e;super(t),e=this,this.makeBasicDefaultOrderParams=()=>{let t=[];return this.props.columns&&this.props.columns.forEach(e=>{e.defaultSortOrder&&t.push("".concat(e.dataIndex," ").concat("descend"===e.sortDirections?"DESC":"ASC"))}),t},this.makeQueryParams=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s={};const{pagination:i,filters:n,sorter:a}=e.state;s.search=[];const o=Object.keys(n),r=t=>t&&t.format?t.format("DD.MM.YYYY"):t;return o.forEach(t=>{if(!n[t])return;const i=e.columnGet(t),a=n[t];if(i.date){if(a[0]){const e="week"===i.date?"week":"month"===i.date?"month":"day",n=a[0].startOf(e).startOf("day"),o=a[0].endOf(e).endOf("day");s.search.push({field:t,compare:"LEQ",value:r(n)}),s.search.push({field:i.dateDataIndex?i.dateDataIndex:t,compare:"GEQ",value:r(o)})}}else if(i.period){if(a[1]){var o,c;const e=null===(o=a[0])||void 0===o?void 0:o.startOf("day"),i=null===(c=a[1])||void 0===c?void 0:c.endOf("day");e&&s.search.push({field:t,compare:"GEQ",value:r(e)}),i&&s.search.push({field:t,compare:"LEQ",value:r(i)})}}else if(i.filterMultiple)a[0]&&s.search.push({field:t,valarr:a});else if(i.text)a[0]&&s.search.push({field:t,compare:"IKE",value:"%".concat(a[0],"%")});else{if(i.numeric){const e=a[0],n=a[1],o=void 0!==e&&null!==e&&""!==e,r=void 0!==n&&null!==n&&""!==n;return o&&s.search.push({field:t,compare:"GEQ",value:String(e)}),r&&s.search.push({field:t,compare:"LEQ",value:String(n)}),void(r||o||void 0===a[0]||s.search.push({field:t,compare:i.numericCompare||"GEQ",value:String(a[0])}))}if(i.address){const t=Array.isArray(a)?a[0]:a;if(!t)return;const e=(t,e)=>{e&&s.search.push({field:t,compare:"IKE",value:"%".concat(e,"%")})},i=(t,e)=>{void 0!==e&&null!==e&&""!==String(e).trim()&&s.search.push({field:t,compare:"EQL",value:String(e).trim()})};return e("city",t.city),e("settlement",t.settlement),e("street",t.street),i("house",t.house),i("building",t.building),i("structure",t.structure),void i("apartment",t.apartment)}s.search.push({field:t,valarr:a})}}),e.props.forceSearch&&(s.search=s.search.concat(e.props.forceSearch)),e.props.forceFilter&&(s.filter=e.props.forceFilter),a.column?s.orderby=["".concat(a.field," ").concat("ascend"===a.order?"ASC":"DESC")]:a.field||(s.orderby=e.props.forceOrder||e.makeBasicDefaultOrderParams()),i.total&&!t.skipPagination&&(s.reclimit=i.pageSize,s.recoffset=(i.current-1)*i.pageSize),s},this.columnGet=t=>{let e={};return this.state.columns.forEach(s=>{s.dataIndex===t&&(e=s)}),e},this.sum=async()=>{if(0===this.state.columns.length)return 0;let t=await this.context.api.q(this.props.path.replace("/list","/sum"),this.makeQueryParams({skipPagination:!0}),!1,this.props.forceToken||!1,this.props.skipToken||!1);return this.props.onSumEnd&&this.props.onSumEnd(t.sum),t.sum},this.count=async()=>{if(0===this.state.columns.length)return 0;let t=await this.context.api.q(this.props.path.replace("/list","/count"),this.makeQueryParams({skipPagination:!0}),!1,this.props.forceToken||!1,this.props.skipToken||!1);return this.props.onCountEnd&&this.props.onCountEnd(t.count),t.count},this.load=async()=>{let{pagination:t,columns:e,sum:s}=this.state;if(0===e.length)return;let i=[];this.loadStart(),t.total=await this.count(),t.total&&(i=await this.context.api.q(this.props.path,this.makeQueryParams(),{toArray:!0},this.props.forceToken||!1,this.props.skipToken||!1)),this.props.onSumEnd&&(s=await this.sum()),this.setState({data:i,pagination:t,sum:s}),this.loadEnd()},this.loadStart=()=>{this.setState({loading:!0}),this.props.onLoadStart&&this.props.onLoadStart()},this.loadEnd=()=>{this.setState({loading:!1}),this.props.onLoadEnd&&this.props.onLoadEnd(this.state.data)},this.handleTableChange=(t,e,s)=>{this.props.preserveState&&this.saveState(t,e,s),this.props.onFilter&&this.props.onFilter(e),this.setState({pagination:t,filters:e,sorter:s},()=>this.load())},this.saveState=(t,e,s)=>{window.test={pagination:t,filters:e,sorter:s}},this.restoreState=()=>{let t=window.test||{};this.setState(Object(i.a)({},t),()=>this.load())};const s={current:1,pageSize:t.pageSize||20,total:!1};this.state={data:[],sorter:{},loading:!1,columns:t.columns,pagination:s,sum:0,filters:t.filters||{}}}componentDidMount(){this.props.preserveState?this.restoreState():this.load()}componentDidUpdate(t,e,s){if(this.props.columns!==this.state.columns&&this.setState({columns:this.props.columns},()=>this.load()),JSON.stringify(this.props.forceSearch)!==JSON.stringify(t.forceSearch)){let{pagination:t}=this.state;t.current=1,this.setState({pagination:t}),this.load()}this.props.uuid!==t.uuid&&this.load(),this.props.areaId!==t.areaId&&this.load(),this.props.operDateIso!==t.operDateIso&&this.load()}render(){const{columns:t,data:e,pagination:s,loading:i}=this.state;return Object(c.jsx)("div",{children:Object(c.jsx)(r.a,{rowSelection:this.props.rowSelection,scroll:{x:400},showSorterTooltip:!1,columns:t,rowKey:t=>t.id,dataSource:e,pagination:s,loading:i||this.props.loading,onChange:this.handleTableChange})})}}l.contextType=o.a},629:function(t,e,s){"use strict";s.d(e,"a",function(){return l});s(0);var i=s(764),n=s(595),a=s(127),o=s(362),r=s(126),c=s(3);function l(t){const{setSelectedKeys:e,selectedKeys:s,confirm:l,clearFilters:h}=t;const p=Object(o.a)();return Object(c.jsx)("div",{style:{padding:8},children:Object(c.jsxs)(i.b,{children:[Object(c.jsx)(n.a,{placeholder:p.formatMessage({id:"DataTableSearch.placeholder"}),value:s[0]||"",onChange:function(t){e([t.target.value])},onKeyPress:function(t){"Enter"===t.key&&l()}}),Object(c.jsx)("div",{style:{paddingTop:12},children:Object(c.jsx)(a.a,{type:"primary",onClick:()=>l(),children:Object(c.jsx)(r.a,{id:"DataTableSearch.search"})})}),Object(c.jsx)("div",{style:{paddingTop:12},children:Object(c.jsx)(a.a,{onClick:()=>h(),children:Object(c.jsx)(r.a,{id:"DataTableSearch.reset"})})})]})})}},631:function(t,e,s){"use strict";var i=s(601),n=s(389),a=s(632),o=s(261),r=s(693),c=s(172),l=s(0),h=s.n(l),p=s(100),d=s(136),u=s(633),m=s(3);const{confirm:g}=i.a;class f extends h.a.Component{constructor(t){super(t),this.popoverToggle=()=>{this.setState(t=>({popoverOpen:!t.popoverOpen,methods:t.popoverOpen?t.methods:[]}),()=>this.load())},this.pendingStart=()=>{this.props.onPendingStart?this.props.onPendingStart():this.setState({pending:!0})},this.pendingEnd=()=>{this.props.onPendingEnd?this.props.onPendingEnd():this.setState({pending:!1})},this.load=async()=>{if(this.state.popoverOpen){this.pendingStart();let t=await this.context.api.q("/".concat(this.props.classcode,"/method"),{id:this.props.id},{toArray:!0});this.setState({methods:t},()=>this.pendingEnd())}},this.run=async t=>{this.pendingStart();let e=await this.context.api.q("/method/run",{id:this.props.id,method:t.id});this.pendingEnd(),this.popoverToggle(),e?(n.b.success(this.m("method.success")),this.props.onFinish&&this.props.onFinish(t)):(n.b.error(this.m("method.fail")),this.setState({pending:!1}))},this.ask=async t=>{"drop"===t.actioncode?g({title:this.m("method.confirm.title"),content:this.m("method.confirm.text"),icon:Object(m.jsx)(d.a,{}),onOk:()=>{this.run(t)}}):this.run(t)},this.m=t=>{const{intl:e}=this.props;return e.formatMessage({id:t})},this.state={popoverOpen:!1,methods:[]}}render(){var t;if(null===(t=this.props)||void 0===t||!t.statelabel)return null;const{pending:e,methods:s=[]}=this.state,i=Object(m.jsx)(a.a,{className:"gx-m-0",color:{created:"processing",enabled:"success",disabled:"default",deleted:"error"}[this.props.statetypecode],children:this.props.statelabel});return this.props.readOnly?i:Object(m.jsx)(o.a,{content:Object(m.jsx)("div",{className:"".concat(0===s.length&&"gx-p-3"),children:Object(m.jsx)(r.a,{spinning:e,children:s.map(t=>t.visible?Object(m.jsx)("div",{onClick:()=>this.ask(t),className:"gx-my-2 gx-pointer gx-link",children:t.label},t.id):null)})}),trigger:"click",open:this.state.popoverOpen,onOpenChange:this.popoverToggle,children:Object(m.jsx)("div",{className:"gx-pointer",children:i})})}}f.contextType=p.a;e.a=Object(u.b)(Object(c.c)(f),{statelabel:t=>t.statenewlabel,statetypecode:t=>t.statenewtypecode})},632:function(t,e,s){"use strict";var i=s(4),n=s(6),a=s(7),o=s(113),r=s(8),c=s.n(r),l=s(43),h=s(0),p=s(81),d=s(255),u=s(256),m=function(t,e){var s={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(s[i]=t[i]);if(null!=t&&"function"===typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(t);n<i.length;n++)e.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(t,i[n])&&(s[i[n]]=t[i[n]])}return s},g=function(t){var e=t.prefixCls,s=t.className,a=t.checked,o=t.onChange,r=t.onClick,l=m(t,["prefixCls","className","checked","onChange","onClick"]),d=(0,h.useContext(p.b).getPrefixCls)("tag",e),u=c()(d,Object(i.a)(Object(i.a)({},"".concat(d,"-checkable"),!0),"".concat(d,"-checkable-checked"),a),s);return h.createElement("span",Object(n.a)({},l,{className:u,onClick:function(t){null===o||void 0===o||o(!a),null===r||void 0===r||r(t)}}))},f=function(t,e){var s={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(s[i]=t[i]);if(null!=t&&"function"===typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(t);n<i.length;n++)e.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(t,i[n])&&(s[i[n]]=t[i[n]])}return s},b=new RegExp("^(".concat(d.a.join("|"),")(-inverse)?$")),v=new RegExp("^(".concat(d.b.join("|"),")$")),j=function(t,e){var s=t.prefixCls,r=t.className,d=t.style,m=t.children,g=t.icon,j=t.color,O=t.onClose,x=t.closeIcon,y=t.closable,S=void 0!==y&&y,C=f(t,["prefixCls","className","style","children","icon","color","onClose","closeIcon","closable"]),w=h.useContext(p.b),E=w.getPrefixCls,k=w.direction,P=h.useState(!0),M=Object(a.a)(P,2),T=M[0],I=M[1];h.useEffect(function(){"visible"in C&&I(C.visible)},[C.visible]);var F=function(){return!!j&&(b.test(j)||v.test(j))},D=Object(n.a)({backgroundColor:j&&!F()?j:void 0},d),q=F(),K=E("tag",s),L=c()(K,Object(i.a)(Object(i.a)(Object(i.a)(Object(i.a)({},"".concat(K,"-").concat(j),q),"".concat(K,"-has-color"),j&&!q),"".concat(K,"-hidden"),!T),"".concat(K,"-rtl"),"rtl"===k),r),N=function(t){t.stopPropagation(),null===O||void 0===O||O(t),t.defaultPrevented||"visible"in C||I(!1)},Q="onClick"in C||m&&"a"===m.type,V=Object(l.a)(C,["visible"]),A=g||null,G=A?h.createElement(h.Fragment,null,A,h.createElement("span",null,m)):m,U=h.createElement("span",Object(n.a)({},V,{ref:e,className:L,style:D}),G,S?x?h.createElement("span",{className:"".concat(K,"-close-icon"),onClick:N},x):h.createElement(o.a,{className:"".concat(K,"-close-icon"),onClick:N}):null);return Q?h.createElement(u.a,null,U):U},O=h.forwardRef(j);O.CheckableTag=g;e.a=O},633:function(t,e,s){"use strict";s.d(e,"a",function(){return l}),s.d(e,"b",function(){return h});var i=s(2),n=s(0),a=s.n(n),o=s(35),r=s(141),c=s(3);const l={is:!1,tick:()=>{l.fetch()},goOffline:()=>{l.is&&(l.is=!1,l.dispatch("onlineGoOffline"),l.log("Went offline"))},goOnline:()=>{l.is||(l.is=!0,l.dispatch("onlineGoOnline"),l.log("Back On Line"))},dispatch:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};window.dispatchEvent(new CustomEvent(t,{detail:e}))},fetch:async()=>{let t=r.a.get();if(t){let a=new Date;a.setMilliseconds(a.getMilliseconds()-(o.a.apiCheckInterval+5e3));const r=JSON.stringify({search:[{field:"datetime",value:a,compare:"GEQ"}],reclimit:500,orderby:["datetime DESC"]});let c=null,h=null,p=new Headers;p.append("Content-Type","application/json"),p.append("Authorization","Bearer ".concat(t));const d="".concat(o.a.apiDomain).concat(o.a.apiPath,"/notification/list");try{var e,s,i;if(h=await fetch(d,{method:"POST",headers:p,body:r,mode:"cors",cache:"no-store"}),h)if(c=await h.json(),null!==(e=c)&&void 0!==e&&e.error)return l.error(null===(s=c)||void 0===s||null===(i=s.error)||void 0===i?void 0:i.message);l.goOnline()}catch(n){return l.goOffline(),l.error(n.message)}if(c){let t={};(Array.isArray(c)?c:[c]).forEach(e=>{t[e.object]||(t[e.object]=e)});let e=Object.keys(t).length;e>0&&(l.dispatch("onlineChanged",{items:t}),l.log("messages count "+e))}return!1}},error:t=>(o.a.debug&&console.log('%c OnLine: ERROR "'.concat(t,'"'),"color: orange"),!1),log:t=>{o.a.debug&&console.log("%c OnLine: ".concat(t),"color: cyan")}};function h(t,e){const s=Object.keys(e);return class extends a.a.Component{constructor(t){super(t),this.onOnlineChanged=t=>{var i;let n=null===t||void 0===t||null===(i=t.detail)||void 0===i?void 0:i.items[this.props.id];n&&(this.setState(t=>{let{passProps:i}=t;return s.forEach(t=>{i[t]=e[t](n)}),{passProps:i}}),this.setState({data:n}))},this.state={data:{},passProps:{}}}componentDidMount(){window.addEventListener("onlineChanged",this.onOnlineChanged)}componentWillUnmount(){window.removeEventListener("onlineChanged",this.onOnlineChanged)}componentDidUpdate(t,e,i){let{passProps:n}=this.state,a=!1;s.forEach(e=>{t[e]!==this.props[e]&&(n[e]=this.props[e],a=!0)}),a&&this.setState({passProps:n})}render(){const{passProps:e}=this.state;return Object(c.jsx)(t,Object(i.a)(Object(i.a)({},this.props),e))}}}!window.onlineInterval&&o.a.apiCheckInterval&&window.setInterval(()=>l.tick(),o.a.apiCheckInterval)},635:function(t,e,s){"use strict";var i=s(0),n=s.n(i),a=s(172),o=s(717),r=s(100),c=s(3);const{Option:l}=o.a;class h extends n.a.Component{constructor(t){super(t),this.createSearch=()=>{let t=this.props.search||[];return this.state.searchText&&this.props.async&&t.push({field:this.props.labelKey||"label",compare:"IKE",value:"%".concat(this.state.searchText,"%")}),this.props.enabledOnly&&t.push({field:"statetypecode",compare:"EQL",value:"enabled"}),this.props.client&&t.push({field:"client",value:this.props.client}),t},this.getLabelKey=()=>this.props.labelKey||"label",this.getIdKey=()=>this.props.valueKey||"id",this.shureHaveValue=async()=>{if(this.props.async&&!this.state.items.find(t=>t[this.getIdKey()]===this.props.value)){this.setState({pending:!0});let t=await this.context.api.q("/object/get",{id:this.props.value,fields:[this.getIdKey(),this.getLabelKey()]});this.setState({pending:!1}),null!==t&&void 0!==t&&t[this.getLabelKey()]&&this.setState(e=>{let{items:s}=e;return s.push(t),{items:s}})}},this.load=async()=>{if(this.props.items)return void this.setState({items:this.props.items});let t=[],e=this.props.async?1:0;if(this.props.query){this.setState({pending:!0});let s=this.createSearch(),i=[this.getIdKey(),this.getLabelKey()].concat(this.props.extraFields||[]),n=this.props.cache?this.context.api.cache:this.context.api.q;t=await n(this.props.query,{search:s,reclimit:e,fields:i},{toArray:!0}),this.setState({pending:!1,items:t})}},this.onSearch=async t=>{this.props.async&&this.setState({searchText:t},()=>this.load())},this.onChange=t=>{let e=this.state.items.find(e=>e[this.getIdKey()]===t);this.props.onChange(t,e)},this.state={searchText:"",pending:!1,items:[]}}componentDidMount(){this.load().then(this.shureHaveValue())}componentDidUpdate(t,e,s){t.value!==this.props.value&&this.shureHaveValue()}render(){let t=this.state.items.map((t,e)=>{let s=t||{},i=s[this.getIdKey()],n=this.props.formatLabel?this.props.formatLabel(t):s[this.getLabelKey()];return Object(c.jsx)(l,{value:i,children:n},e)});return Object(c.jsx)(o.a,{defaultActiveFirstOption:!1,allowClear:this.props.allowClear,loading:!!this.state.pending,value:this.state.pending?null:this.props.value,showSearch:!0,placeholder:this.props.placeholder,optionFilterProp:"children",onChange:this.onChange,onSearch:this.onSearch,filterOption:(t,e)=>e.children.toLowerCase().indexOf(t.toLowerCase())>=0,children:t})}}h.contextType=r.a,e.a=Object(a.c)(h)},637:function(t,e,s){"use strict";var i=s(2),n=s(0),a={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M482 152h60q8 0 8 8v704q0 8-8 8h-60q-8 0-8-8V160q0-8 8-8z"}},{tag:"path",attrs:{d:"M192 474h672q8 0 8 8v60q0 8-8 8H160q-8 0-8-8v-60q0-8 8-8z"}}]},name:"plus",theme:"outlined"},o=s(12),r=function(t,e){return n.createElement(o.a,Object(i.a)(Object(i.a)({},t),{},{ref:e,icon:a}))},c=n.forwardRef(r);e.a=c},641:function(t,e,s){"use strict";var i=s(0),n=s.n(i),a=s(389),o=s(601),r=s(693),c=s(763),l=s(599),h=s(127),p=s(100),d=s(172),u=s(3);class m extends n.a.Component{constructor(t){var e;super(t),e=this,this.pendingStart=()=>{this.props.onPendingStart?this.props.onPendingStart():this.setState({loadPending:!0})},this.pendingEnd=()=>{this.props.onPendingEnd?this.props.onPendingEnd():this.setState({loadPending:!1})},this.load=async()=>{if(this.props.id){this.pendingStart();let t=this.props.queryParams||{id:this.props.id},e=this.props.loadPath||"/".concat(this.props.essence,"/get"),s=await this.context.api.q(e,t,{exact:!0});this.setState({initialValues:s||{}},()=>this.pendingEnd())}else this.setState({initialValues:{}})},this.save=async t=>{let e=this.state.initialValues,s=this.props.prepareData?this.props.prepareData({data:t,item:e}):t,i=this.props.savePath||"/".concat(this.props.essence,"/set");s.id=e.id||null,this.setState({savePending:!0}),console.log("@@@",i,s),await this.context.api.q(i,s)?(a.b.success(this.m("save.success","")),this.props.onFinish&&this.props.onFinish()):(a.b.error(this.m("save.fail","")),this.setState({pending:!1})),this.setState({savePending:!1})},this.onClose=()=>{this.props.onClose&&this.props.onClose()},this.m=function(t){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"editmodal.";const{intl:i}=e.props;return i.formatMessage({id:s+t})},this.state={loadPending:!1,savePending:!1,initialValues:{}}}componentDidMount(){this.load()}componentDidUpdate(t,e,s){t.id!==this.props.id&&this.load()}render(){const{visible:t,essence:e,id:s}=this.props,{loadPending:i,savePending:n,initialValues:a}=this.state;return Object(u.jsx)(o.a,{open:t,footer:null,onCancel:this.onClose,children:Object(u.jsx)(r.a,{spinning:i,children:i||!s||a.id?Object(u.jsx)("div",{className:"gx-p-3",children:Object(u.jsxs)(l.a,{name:e,layout:"vertical",initialValues:a,onFinish:this.save,scrollToFirstError:!0,children:[this.props.form,Object(u.jsx)(h.a,{loading:n,type:"primary",htmlType:"submit",className:"gx-mb-0",children:this.m("save","")})]},a.id)}):Object(u.jsx)(c.a,{})})})}}m.contextType=p.a,e.a=Object(d.c)(m)},760:function(t,e,s){"use strict";s.d(e,"a",function(){return c});s(0);var i=s(635),n=s(595),a=s(599),o=s(3);const{TextArea:r}=n.a;function c(t){var e;let{essence:s}=t;const c=(null===(e=window.appConfig)||void 0===e?void 0:e.adminReferences[s])||{};let l={name:{rules:[{required:!0}]},type:{rules:[{required:!0}],label:this.m("typename"),component:Object(o.jsx)(i.a,{labelKey:"name",cache:!0,query:"/".concat(s,"/type")})},description:{component:Object(o.jsx)(r,{})}};return c.extraFields&&Object.entries(c.extraFields).forEach(t=>{let[e,s]=t;l[e]={label:this.m(e)},"reference"===s.type&&(l[e].component=Object(o.jsx)(i.a,{labelKey:"name",cache:!0,query:s.path})),s.required&&(l[e].rules=[{required:!0}])}),Object(o.jsx)(o.Fragment,{children:Object.entries(l).map(t=>{let[e,s]=t,i=s.label||this.m(e),r=s.component||Object(o.jsx)(n.a,{});return Object(o.jsx)(a.a.Item,{rules:s.rules,label:i,name:e,children:r},e)})})}}}]);
//# sourceMappingURL=26.e8de026f.chunk.js.map