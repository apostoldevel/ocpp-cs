{"version":3,"sources":["routes/Stations/DriverStationDetail.js","routes/Stations/DriverStationsYandex.js","routes/Stations/DriverStationsGoogle.js","routes/Stations/DriverStationsProvider.jsx","util/Statelabel.js","api/online.js","util/PlainSelect.js","util/paramsHasChanged.js","routes/Connectors/ConnectorButtons.js"],"names":["online","tick","DriverStationDetail","React","Component","constructor","props","_this","super","this","m","key","prefix","arguments","length","undefined","intl","formatMessage","id","pendingStart","onPendingStart","setState","pending","pendingEnd","onPendingEnd","load","async","stationId","readings","context","api","q","toArray","item","access","files","Promise","allSettled","map","result","value","chargeToggle","detailPending","message","error","success","reserveToggle","state","componentDidMount","componentDidUpdate","prevProps","prevState","snapshot","locale","render","connectors","DetailRow","_ref","property","connected","Date","toLocaleString","_jsxs","Row","gutter","className","children","_jsx","Col","xs","Spin","spinning","Empty","description","Flex","between","Statelabel","_objectSpread","readOnly","u","onFinish","prop","_Fragment","c","idx","chargername","chargerdescription","style","whiteSpace","ConnectorButtons","Link","to","concat","Button","f","alt","src","link","contextType","Context","withRouter","injectIntl","DriverStationsYandex","getYandexLanguage","language","toUpperCase","getMapLanguage","appConfig","storedLanguage","localStorage","getItem","defaultLanguage","mapLanguage","setParams","param1","carId","param2","chargerId","match","params","search","push","field","compare","charger","stations","getItemGeo","_item$geo","geo","lat","latitude","lng","longitude","drawerClose","drawerVisible","onPlacemarkClick","drawerItem","window","config","yandexMapsApiKey","process","mapDefaultCenter","mapLoaded","paramsHasChanged","Array","isArray","points","filter","mapRef","createRef","lang","apikey","CircularProgress","Drawer","title","label","placement","onClose","visible","CustomScrollbars","Helmet","visibility","Card","size","PlainSelect","placeholder","formatLabel","identity","extraFields","enabledOnly","labelKey","query","onChange","v","history","chargerac","YMaps","Map","defaultState","center","zoom","width","height","modules","onLoad","maps","current","setBounds","util","bounds","fromPoints","instanceRef","ref","balloonContent","modelname","vendorname","Placemark","defaultGeometry","onClick","options","iconLayout","iconImageHref","iconImageSize","ZoomControl","mapContainerStyle","defaultCenter","markerIconConfig","DriverStationsGoogle","startLanguagePolling","languageCheckInterval","setInterval","checkLanguageChange","newLanguage","currentLanguage","handleLanguageChange","actualNewLanguage","googleMapsReady","parseFloat","onMarkerClick","station","createMarkerIcon","google","Size","markerIcon","url","scaledSize","fitBounds","LatLngBounds","console","warn","setCenter","setZoom","forEach","point","extend","onMapLoad","setTimeout","onScriptLoad","loadError","onScriptError","getRegionFromLanguage","loadLanguage","googleMapsApiKey","componentWillUnmount","clearInterval","renderMapContent","Marker","position","icon","opacity","transition","LoadScript","region","loadingElement","background","onError","GoogleMap","zoomControl","streetViewControl","mapTypeControl","fullscreenControl","DriverStationsProvider","confirm","Modal","popoverToggle","popoverOpen","methods","classcode","run","method","ask","actioncode","content","ExclamationCircleOutlined","onOk","_this$props","statelabel","Tag","color","created","enabled","disabled","deleted","statetypecode","Popover","trigger","open","onOpenChange","withOnline","d","statenewlabel","statenewtypecode","is","fetch","goOffline","dispatch","log","goOnline","type","detail","dispatchEvent","CustomEvent","token","accessToken","get","dt","setMilliseconds","getMilliseconds","apiCheckInterval","body","JSON","stringify","reclimit","orderby","json","response","headers","Headers","append","apiDomain","apiPath","_json","_json2","_json2$error","mode","cache","e","items","n","object","itemsCount","Object","keys","debug","mapOnlineProps","propsKeys","onOnlineChanged","_e$detail","data","passProps","propName","addEventListener","removeEventListener","anyChanges","onlineInterval","Option","Select","createSearch","searchText","client","getLabelKey","getIdKey","valueKey","shureHaveValue","find","fields","fetchFn","onSearch","i","then","option","defaultActiveFirstOption","allowClear","loading","showSearch","optionFilterProp","filterOption","input","toLowerCase","indexOf","prevParams","nowParams","param3","charging","includes","statecode","reserved","Fragment","Tooltip","stopPropagation","FallOutlined","HistoryOutlined","statenewcode"],"mappings":"uVAeAA,IAAOC,OAEP,MAAMC,UAA4BC,IAAMC,UAGtCC,YAAYC,GAAQ,IAADC,EACjBC,MAAMF,GAAMC,EAAAE,KAAC,KAYfC,EAAI,SAACC,GAA+B,IAA1BC,EAAMC,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAG,YACjB,MAAM,KAACG,GAAQT,EAAKD,MACpB,OAAOU,EAAKC,cAAc,CAACC,GAAIN,EAASD,GAC1C,EAAE,KAEFQ,aAAe,KACTV,KAAKH,MAAMc,eACbX,KAAKH,MAAMc,iBAGbX,KAAKY,SAAS,CAACC,SAAS,KACxB,KACFC,WAAa,KACPd,KAAKH,MAAMkB,aACbf,KAAKH,MAAMkB,eAGbf,KAAKY,SAAS,CAACC,SAAS,KACxB,KAeFG,KAAOC,UACL,GAAIjB,KAAKH,MAAMqB,UAAW,CACxBlB,KAAKU,eAEL,IAAIS,EAAW,OACPnB,KAAKoB,QAAQC,IAAIC,EAAE,oBAAqB,CAC5Cb,GAAIT,KAAKH,MAAMqB,kBAEXlB,KAAKoB,QAAQC,IAAIC,EAAE,wBAAyB,CAChDb,GAAIT,KAAKH,MAAMqB,kBAEXlB,KAAKoB,QAAQC,IAAIC,EACrB,eACA,CACEb,GAAIT,KAAKH,MAAMqB,WAEjB,CAACK,SAAS,MAGTC,EAAMC,EAAQC,UAAgBC,QAAQC,WAAWT,IAAWU,IAC9DC,GAAWA,EAAOC,OAGrB/B,KAAKY,SAAS,CAACY,OAAMC,SAAQC,SAAQ,IAAM1B,KAAKc,aAClD,MACEd,KAAKY,SAAS,CAACY,KAAM,CAAC,EAAGC,OAAQ,CAAC,EAAGC,MAAO,MAE9C,KAEFM,aAAef,iBAA6B,IAAtBO,EAAIpB,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAG,CAAC,EAAG2B,EAAK3B,UAAAC,OAAA,EAAAD,UAAA,QAAAE,EACpC,GAAIkB,EAAKf,GAAI,CACXX,EAAKc,SAAS,CAACqB,eAAe,IAC9B,IAAIH,GAAS,EAEXA,EADEC,QACajC,EAAKsB,QAAQC,IAAIC,EAAE,yBAA0B,CAC1Db,GAAIe,EAAKf,WAGIX,EAAKsB,QAAQC,IAAIC,EAAE,0BAA2B,CAC3Db,GAAIe,EAAKf,KAGbX,EAAKc,SAAS,CAACqB,eAAe,KACf,IAAXH,EACFI,IAAQC,MAAMrC,EAAKG,EAAE,cAAe,KAEpCiC,IAAQE,QAAQtC,EAAKG,EAAE,iBAAkB,WAErCH,EAAKkB,MACb,CACF,EAAE,KAEFqB,cAAgBpB,iBAA6B,IAAtBO,EAAIpB,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAG,CAAC,EAAG2B,EAAK3B,UAAAC,OAAA,EAAAD,UAAA,QAAAE,EACrC,GAAIkB,EAAKf,GAAI,CACXX,EAAKc,SAAS,CAACqB,eAAe,IAC9B,IAAIH,GAAS,EAEXA,EADEC,QACajC,EAAKsB,QAAQC,IAAIC,EAAE,4BAA6B,CAC7Db,GAAIe,EAAKf,WAGIX,EAAKsB,QAAQC,IAAIC,EAAE,yBAA0B,CAC1Db,GAAIe,EAAKf,KAGbX,EAAKc,SAAS,CAACqB,eAAe,KACf,IAAXH,EACFI,IAAQC,MAAMrC,EAAKG,EAAE,cAAe,KAEpCiC,IAAQE,QAAQtC,EAAKG,EAAE,iBAAkB,WAErCH,EAAKkB,MACb,CACF,EApHEhB,KAAKsC,MAAQ,CACXL,eAAe,EACfpB,SAAS,EACTK,WAAW,EACXM,KAAM,CAAC,EACPC,OAAQ,CAAC,EACTC,MAAO,GAEX,CAsBAa,oBACEvC,KAAKgB,MACP,CAEAwB,mBAAmBC,EAAWC,EAAWC,GAErCF,EAAUvB,YAAclB,KAAKH,MAAMqB,WACnCuB,EAAUlC,KAAKqC,SAAW5C,KAAKH,MAAMU,KAAKqC,QAE1C5C,KAAKY,SAAS,CAACY,KAAM,CAAC,GAAI,IAAMxB,KAAKgB,OAEzC,CA6EA6B,SACE,MAAM,QAAChC,EAAO,KAAEW,EAAI,OAAEC,EAAM,MAAEC,GAAS1B,KAAKsC,MACtCQ,EAAatB,EAAKsB,YAAc,GAgBhCC,EAAYC,IAAkC,IAAjC,KAACxB,EAAI,SAAEyB,EAAQ,UAAEC,GAAUF,EACxCjB,EAAY,OAAJP,QAAI,IAAJA,OAAI,EAAJA,EAAOyB,GAQnB,MAPqB,kBAAVlB,EACQ,eAAbkB,GAA0C,YAAbA,GAAuC,qBAAbA,IACzDlB,EAAQ,IAAIoB,KAAKpB,GAAOqB,kBAEA,mBAAVrB,IAChBA,EAAQA,EAAQ/B,KAAKC,EAAE,QAAUD,KAAKC,EAAE,UAErC8B,EAEHsB,eAACC,IAAG,CAACC,OAAQ,CAAC,GAAI,IAAKC,UAAU,UAASC,SAAA,CACxCC,cAACC,IAAG,CAACH,UAAU,6CAA6CI,GAAI,GAAGH,SACnD,qBAAbR,EAAkCC,EAAYlD,KAAKC,EAAEgD,GAAYjD,KAAKC,EAAE,gBAAkBD,KAAKC,EAAEgD,KAEpGS,cAACC,IAAG,CAACC,GAAI,GAAGH,SAAE1B,OANC,MAWrB,OACE2B,cAAA,OAAAD,SACEJ,eAACQ,IAAI,CAACC,SAAUjD,EAAQ4C,SAAA,GAChB,OAAJjC,QAAI,IAAJA,KAAMf,KAAMiD,cAACK,IAAK,KACf,OAAJvC,QAAI,IAAJA,OAAI,EAAJA,EAAMf,KACL4C,eAAA,OAAKG,UAAU,UAASC,SAAA,EACjB,OAAJjC,QAAI,IAAJA,OAAI,EAAJA,EAAMwC,cACLN,cAAA,OAAKF,UAAU,6CAA4CC,SACxDjC,EAAKwC,cAGVX,eAACY,IAAI,CAACC,SAAO,EAACV,UAAU,kBAAiBC,SAAA,CACvCC,cAAA,MAAAD,SAAKzD,KAAKC,EAAE,aACZyD,cAACS,IAAUC,wBAAA,GACL5C,GAAI,IACR6C,WAAiB,OAAN5C,QAAM,IAANA,KAAQ6C,GACnBC,SAAUvE,KAAKgB,WAlDF,CACzB,WACA,YACA,aACA,eACA,kBACA,QACA,OACA,cACA,YACA,mBACA,cA0C4Ba,IAAK2C,GACvBd,cAACX,EAAS,CAAYvB,KAAMA,EAAMyB,SAAUuB,EAAMtB,UAAW1B,EAAK0B,WAAlDsB,IAEjB1B,EAAWzC,OAAS,GACnBqD,cAAAe,WAAA,CAAAhB,SACEJ,eAACQ,IAAI,CAACC,SAAU9D,KAAKsC,MAAML,cAAcwB,SAAA,CACvCC,cAAA,SACCZ,EAAWjB,IAAI,CAAC6C,EAAGC,IAEhBjB,cAAA,OAAKF,UAAU,UAASC,SACtBJ,eAACY,IAAI,CAACC,SAAO,EAAAT,SAAA,CACXJ,eAAA,OAAAI,SAAA,CACGiB,EAAEE,YACHlB,cAAA,OAAKF,UAAU,mDAAkDC,SAC9DiB,EAAEG,wBAGPxB,eAAA,OAAKG,UAAU,kBAAiBC,SAAA,CAC9BC,cAACS,IAAUC,wBAAA,GACLM,GAAC,IACLL,UAAU,EACVE,SAAUvE,KAAKgB,QAEjB0C,cAAA,OAAKoB,MAAO,CAACC,WAAY,UAAUtB,SACjCC,cAACsB,IAAgBZ,wBAAA,CACfnE,EAAGD,KAAKC,GACJyE,GAAC,IACL1C,aAAeD,GACb/B,KAAKgC,aAAa0C,EAAG3C,GAEvBM,cAAgBN,GACd/B,KAAKqC,cAAcqC,EAAG3C,eAtBJ4C,UAkCjC,OAANlD,QAAM,IAANA,OAAM,EAANA,EAAQ6C,IACPZ,cAACuB,IAAI,CAACC,GAAE,gBAAAC,OAAkB3D,EAAKf,IAAKgD,SAClCC,cAAC0B,IAAM,CAAC5B,UAAU,kBAAiBC,SAChCzD,KAAKC,EAAE,OAAQ,QAIrByB,EAAMrB,OAAS,GACdgD,eAAAoB,WAAA,CAAAhB,SAAA,CACEC,cAAA,SACChC,EAAMG,IAAI,CAACwD,EAAGV,IAEXjB,cAAA,OAEE4B,IAAI,GACJC,IAAKF,EAAEG,MAFFb,cAa3B,EA1PIlF,EACGgG,YAAcC,IA4PRC,kBAAWC,YAAWnG,ICjQrC,MAAMoG,UAA6BnG,IAAMC,UAEvCC,YAAYC,GAAQ,IAADC,EACjBC,MAAMF,GAAMC,EAAAE,KAAC,KA6Bf8F,kBAAqBC,IACH,CACd,GAAM,QACN,GAAM,QACN,GAAM,QACN,GAAM,QACN,GAAM,SAGOA,IAAaA,EAASC,eACrC,KAEFC,eAAkBC,IAChB,MAAMC,EAAiBC,aAAaC,QAAQ,yBACtCC,EAAkBJ,EAAUK,aAAeL,EAAUI,gBAC3D,OAAOtG,KAAK8F,kBAAkBK,GAAkCG,IACjE,KAED5F,aAAe,KACTV,KAAKH,MAAMc,eACbX,KAAKH,MAAMc,iBAGbX,KAAKY,SAAS,CAAEC,SAAS,KACzB,KAEFC,WAAa,KACPd,KAAKH,MAAMkB,aACbf,KAAKH,MAAMkB,eAGbf,KAAKY,SAAS,CAAEC,SAAS,KACzB,KAEFZ,EAAI,SAACC,GAAmC,IAA9BC,EAAMC,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAG,gBACjB,MAAM,KAAEG,GAAST,EAAKD,MACtB,OAAOU,EAAKC,cAAc,CAAEC,GAAIN,EAASD,GAC3C,EAAE,KAgBFsG,UAAY,KACV,MAAQC,OAAQC,EAAOC,OAAQC,GAAc5G,KAAKH,MAAMgH,MAAMC,OAC9D9G,KAAKY,SACH,CACE8F,QACAE,aAEF,IAAM5G,KAAKgB,SAEb,KAEFA,KAAOC,UACLjB,KAAKU,eAEL,IAAIqG,EAAS,GACT/G,KAAKsC,MAAMsE,WACbG,EAAOC,KAAK,CACVC,MAAO,aACPC,QAAS,MACTnF,MAAO,CAAC,CAAEoF,QAASnH,KAAKsC,MAAMsE,cAIlC,IAAIQ,QAAiBpH,KAAKoB,QAAQC,IAAIC,EACpC,qBACA,CAAEyF,UACF,CAAExF,SAAS,IAGbvB,KAAKY,SAAS,CAAEwG,YAAY,IAAMpH,KAAKc,eACvC,KAEFuG,WAAc7F,IAAU,IAAD8F,EACrB,IAAIC,GAAU,OAAJ/F,QAAI,IAAJA,GAAS,QAAL8F,EAAJ9F,EAAM+F,WAAG,IAAAD,OAAL,EAAJA,EAAY,KAAM,CAAC,EACzBE,EAAMD,EAAIE,SACVC,EAAMH,EAAII,UACd,OAAIH,GAAOE,EACF,CAACF,EAAKE,GAER,MACP,KAEFE,YAAc,KACZ5H,KAAKY,SAAS,CAAEiH,eAAe,KAC/B,KAEFC,iBAAoBC,IAClB/H,KAAKY,SAAS,CAAEmH,aAAYF,eAAe,KA/H3C,MAAM3B,EAAY8B,OAAO9B,WAAa,CAAC,EAMvClG,KAAKiI,OAAM7D,wBAAA,GACN8B,GAAS,IACZgC,iBAAkBC,uCAClB5B,YAAavG,KAAKiG,eAAeC,GACjCkC,iBAAkBlC,EAAUkC,kBAAoB,CAAC,SAAU,WAG7DpI,KAAKsC,MAAQ,CAEX+F,WAAW,EACXxH,SAAS,EACTuG,SAAU,GAEVV,OAAO,EACPE,WAAW,EAEXiB,eAAe,EACfE,WAAY,CAAC,EAEjB,CAyCAxF,oBACEvC,KAAKwG,YACLxG,KAAKgB,MACP,CAEAwB,mBAAmBC,EAAWC,EAAWC,GACnC2F,YAAiB7F,EAAWzC,KAAKH,QACnCG,KAAKwG,YAEH/D,EAAUlC,KAAKqC,SAAW5C,KAAKH,MAAMU,KAAKqC,QAC5C5C,KAAKgB,MAET,CAoDA6B,SACE,MAAM,SAAEuE,EAAQ,UAAEiB,EAAS,QAAExH,EAAO,WAAEkH,GAAe/H,KAAKsC,MAE1D,IAAKiG,MAAMC,QAAQpB,GAAW,OAAO,KAErC,GAAwB,IAApBA,EAAS/G,OAAc,OAAOqD,cAACK,IAAK,IAExC,MAAM0E,EAASrB,EACZvF,IAAKL,GAASxB,KAAKqH,WAAW7F,IAC9BkH,OAAQnB,GAAQA,GACnB,GAAsB,IAAlBkB,EAAOpI,OACT,OACEqD,cAAA,OAAKF,UAAWxD,KAAKH,MAAM2D,UAAUC,SACnCC,cAACK,IAAK,MAKZ,MAAM4E,EAASjJ,IAAMkJ,YAEfC,EAAO7I,KAAKiG,eAAejG,KAAKiI,QAChCa,EAAS9I,KAAKiI,OAAOC,iBACrBE,EAAmBpI,KAAKiI,OAAOG,iBAErC,OACE/E,eAAAoB,WAAA,CAAAhB,SAAA,GACK4E,GAAaxH,IAAY6C,cAACqF,IAAgB,IAC7CrF,cAACsF,IAAM,CACLC,MAAiB,OAAVlB,QAAU,IAAVA,OAAU,EAAVA,EAAYmB,MACnBC,UAAU,QACVC,QAASpJ,KAAK4H,YACdyB,QAASrJ,KAAKsC,MAAMuF,cAAcpE,SAElCC,cAAC4F,IAAgB,CAAA7F,SACfC,cAACjE,EAAmB,CAACyB,UAAqB,OAAV6G,QAAU,IAAVA,OAAU,EAAVA,EAAYtH,SAGhDiD,cAAC6F,IAAM,CAAA9F,SACLC,cAAA,SAAAD,SAAQzD,KAAKC,EAAE,gBAEjBoD,eAAA,OACEG,UAAU,iBACVsB,MAAO,CAAE0E,WAAYnB,IAAcxH,EAAU,UAAY,UAAW4C,SAAA,CAEpEC,cAAA,OAAKF,UAAU,YAAWC,SACxBC,cAAC+F,IAAI,CAACC,KAAK,QAAOjG,SAChBC,cAACiG,IAAW,CACV5H,MAAO/B,KAAKsC,MAAMoE,MAClBkD,YAAa5J,KAAKC,EAAE,UACpB4J,YAAcrI,GAAI,GAAA2D,OAAQ3D,EAAK0H,MAAK,KAAA/D,OAAI3D,EAAKsI,UAC7CC,YAAa,CAAC,WAAY,aAC1BC,aAAW,EACXC,SAAS,QACTC,MAAM,YACNC,SAAUA,CAACC,EAAG5I,KAEZxB,KAAKH,MAAMwK,QAAQrD,KAAK,oBAAD7B,OACDiF,EAAC,KAAAjF,OAAI3D,EAAK8I,WAAa,YAOrD5G,cAAC6G,IAAK,CAAYL,MAAO,CAAEpB,SAAQD,QAAOpF,SACxCJ,eAACmH,IAAG,CACFC,aAAc,CAAEC,OAAQjC,EAAO,IAAML,EAAkBuC,KAAM,GAC7DC,MAAO,OACPC,OAAQ,OACRC,QAAS,CAAC,0BAA2B,eACrCC,OAASC,IACPhL,KAAKY,SAAS,CAAEyH,WAAW,IACvBI,EAAOpI,OAAS,GAClBsI,EAAOsC,QAAQC,UACbF,EAAKG,KAAKC,OAAOC,WAAW5C,KAIlC6C,YAAcC,IACRA,IACF5C,EAAOsC,QAAUM,IAEnB9H,SAAA,CAEmB,IAApB2D,EAAS/G,OAAe+G,EAASvF,IAAI,CAACL,EAAMmD,KAC3C,IAAI4C,EAAMvH,KAAKqH,WAAW7F,GAC1B,IAAK+F,EAAK,OAAO,KAEjB,IAAIiE,EAAiB,GAUrB,OATIhK,EAAKwC,aACPwH,EAAexE,KAAK,QAAD7B,OAAS3D,EAAKwC,aAAe,GAAE,WAChDxC,EAAKiK,WACPD,EAAexE,KAAK,QAAD7B,OACT3D,EAAKiK,WAAa,GAAE,KAAAtG,OAC1B3D,EAAKkK,YAAc,GAAE,WAKzBhI,cAACiI,IAAS,CAERC,gBAAiBrE,EACjBsE,QAASA,IAAM7L,KAAK8H,iBAAiBtG,GACrCsK,QAAS,CACPC,WAAY,gBACZC,cAAexK,EAAK0B,UAAY,iCAAmC,+BACnE+I,cAAe,CAAC,GAAI,MANjBtH,KAUN,GACLjB,cAACwI,IAAW,QA/CJrD,QAqDpB,EA5PIhD,EACGJ,YAAcC,IA8PRC,kBAAWC,YAAWC,I,SC9PrC,MAAMsG,EAAoB,CACxBvB,MAAO,OACPC,OAAQ,QAGJuB,EAAgB,CACpB5E,IAAK,SACLE,IAAK,SAID2E,EACC,iCADDA,EAEE,CAAEzB,MAAO,GAAIC,OAAQ,IAG7B,MAAMyB,UAA6B5M,IAAMC,UAGvCC,YAAYC,GAAQ,IAADC,EACjBC,MAAMF,GAAMC,EAAAE,KAAC,KAkCfU,aAAe,KACTV,KAAKH,MAAMc,eACbX,KAAKH,MAAMc,iBAGbX,KAAKY,SAAS,CAAEC,SAAS,KACzB,KAEFC,WAAa,KACPd,KAAKH,MAAMkB,aACbf,KAAKH,MAAMkB,eAGbf,KAAKY,SAAS,CAAEC,SAAS,KACzB,KAEFZ,EAAI,SAACC,GAAmC,IAA9BC,EAAMC,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAG,gBACjB,MAAM,KAAEG,GAAST,EAAKD,MACtB,OAAOU,EAAKC,cAAc,CAAEC,GAAIN,EAASD,GAC3C,EA6BA,KACAqM,qBAAuB,KACrBvM,KAAKwM,sBAAwBC,YAAY,KACvCzM,KAAK0M,uBACJ,MACH,KAEFA,oBAAsB,KACpB,MAAMvG,EAAiBC,aAAaC,QAAQ,yBACtCH,EAAY8B,OAAO9B,WAAa,CAAC,EACjCI,EAAkBJ,EAAUK,aAAeL,EAAUI,gBACrDqG,EAAcxG,GAAkCG,EAElDqG,IAAgB3M,KAAKsC,MAAMsK,iBAC7B5M,KAAK6M,qBAAqBF,IAE5B,KAEFE,qBAAuB,WAAyB,IAAxBF,EAAWvM,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAG,KACpC,MAAM+F,EAAiBC,aAAaC,QAAQ,yBACtCH,EAAY8B,OAAO9B,WAAa,CAAC,EACjCI,EAAkBJ,EAAUK,aAAeL,EAAUI,gBACrDwG,EAAoBH,GAAexG,GAAkBG,EAEvDwG,IAAsBhN,EAAKwC,MAAMsK,kBAEnC9M,EAAKc,SAAS,CACZgM,gBAAiBE,EACjBC,iBAAiB,EACjB1E,WAAW,IAGbvI,EAAKmI,OAAO1B,YAAcuG,EAE9B,EAAE,KAEFtG,UAAY,KACV,MAAQC,OAAQC,EAAOC,OAAQC,GAAc5G,KAAKH,MAAMgH,MAAMC,OAC9D9G,KAAKY,SACH,CACE8F,QACAE,aAEF,IAAM5G,KAAKgB,SAEb,KAEFA,KAAOC,UACLjB,KAAKU,eAEL,IAAIqG,EAAS,GACT/G,KAAKsC,MAAMsE,WACbG,EAAOC,KAAK,CACVC,MAAO,aACPC,QAAS,MACTnF,MAAO,CAAC,CAAEoF,QAASnH,KAAKsC,MAAMsE,cAGlC,IAAIQ,QAAiBpH,KAAKoB,QAAQC,IAAIC,EACpC,qBACA,CAAEyF,UACF,CAAExF,SAAS,IAEbvB,KAAKY,SAAS,CAAEwG,YAAY,IAAMpH,KAAKc,eACvC,KAEFuG,WAAc7F,IAAU,IAAD8F,EACrB,IAAIC,GAAU,OAAJ/F,QAAI,IAAJA,GAAS,QAAL8F,EAAJ9F,EAAM+F,WAAG,IAAAD,OAAL,EAAJA,EAAY,KAAM,CAAC,EACzBE,EAAMD,EAAIE,SACVC,EAAMH,EAAII,UACd,OAAIH,GAAOE,EACF,CAAEF,IAAKwF,WAAWxF,GAAME,IAAKsF,WAAWtF,IAE1C,MACP,KAEFE,YAAc,KACZ5H,KAAKY,SAAS,CACZiH,eAAe,KAEjB,KAEFoF,cAAiBC,IACflN,KAAKY,SAAS,CACZmH,WAAYmF,EACZrF,eAAe,KAEjB,KAEFsF,iBAAmB,KACbnF,OAAOoF,QAAUpF,OAAOoF,OAAOpC,MAAQhD,OAAOoF,OAAOpC,KAAKqC,OAC5DrN,KAAKsN,WAAa,CAChBC,IAAKlB,EACLmB,WAAY,IAAIxF,OAAOoF,OAAOpC,KAAKqC,KACjChB,EAAsBzB,MACtByB,EAAsBxB,WAI5B,KAEF4C,UAAY,CAAC5L,EAAK4G,KAChB,IAAKT,OAAOoF,SAAWpF,OAAOoF,OAAOpC,OAAShD,OAAOoF,OAAOpC,KAAK0C,aAE/D,YADAC,QAAQC,KAAK,kCAIf,GAAsB,IAAlBnF,EAAOpI,OAAc,OAEzB,GAAsB,IAAlBoI,EAAOpI,OAGT,OAFAwB,EAAIgM,UAAUpF,EAAO,SACrB5G,EAAIiM,QAAQ,IAId,MAAM1C,EAAS,IAAIpD,OAAOoF,OAAOpC,KAAK0C,aACtCjF,EAAOsF,QAAQC,IACb5C,EAAO6C,OAAOD,KAEhBnM,EAAI4L,UAAUrC,IACd,KAEF8C,UAAarM,IACX7B,KAAKY,SAAS,CACZyH,WAAW,EACXxG,QAGF,MAAM,SAAEuF,GAAapH,KAAKsC,MACpBmG,EAASrB,EACZvF,IAAKL,GAASxB,KAAKqH,WAAW7F,IAC9BkH,OAAQnB,GAAQA,GAEfkB,EAAOpI,OAAS,GAClB8N,WAAW,KACLtM,GAAOmG,OAAOoF,QAAUpF,OAAOoF,OAAOpC,MACxChL,KAAKyN,UAAU5L,EAAK4G,IAErB,MAEL,KAEF2F,aAAe,KACbpO,KAAKY,SAAS,CACZmM,iBAAiB,EACjBsB,UAAW,OAEbrO,KAAKmN,oBACL,KAEFmB,cAAiBnM,IACfwL,QAAQxL,MAAM,2CAAuCA,GACrDnC,KAAKY,SAAS,CACZmM,iBAAiB,EACjBsB,UAAWlM,KAIf,KACAoM,sBAAyBxI,IACL,CAChB,GAAM,KACN,GAAM,KACN,GAAM,KACN,GAAM,KACN,GAAM,KACN,GAAM,KACN,GAAM,KACN,GAAM,MAESA,IAAaA,EAASC,eA1PvC,MAAME,EAAY8B,OAAO9B,WAAa,CAAC,EAEjCC,EAAiBC,aAAaC,QAAQ,yBACtCC,EAAkBJ,EAAUK,aAAeL,EAAUI,gBAC3D,IAAIkI,EAAerI,GAAkCG,EAErDtG,KAAKiI,OAAM7D,wBAAA,GACN8B,GAAS,IACZuI,iBAAkBtG,0CAClB5B,YAAaiI,IAGfxO,KAAKsC,MAAQ,CACX+F,WAAW,EACX0E,iBAAiB,EACjBsB,UAAW,KACXxN,SAAS,EACTuG,SAAU,GACVvF,IAAK,KAEL6E,OAAO,EACPE,WAAW,EAEXiB,eAAe,EACfE,WAAY,CAAC,EAEb6E,gBAAiB4B,GAGnBxO,KAAKsN,WAAa,IACpB,CAuBA/K,oBACEvC,KAAKwG,YACLxG,KAAKgB,OACLhB,KAAKuM,sBACP,CAEA/J,mBAAmBC,EAAWC,GACxB4F,YAAiB7F,EAAWzC,KAAKH,QACnCG,KAAKwG,YAGH/D,EAAUlC,KAAKqC,SAAW5C,KAAKH,MAAMU,KAAKqC,QAC5C5C,KAAK6M,wBAIH7M,KAAKsC,MAAMyK,iBAAoBrK,EAAUqK,iBAAoB/M,KAAKsN,YACpEtN,KAAKmN,kBAET,CAEAuB,uBACM1O,KAAKwM,uBACPmC,cAAc3O,KAAKwM,sBAEvB,CAgLAoC,mBACE,MAAM,SAAExH,EAAQ,gBAAE2F,GAAoB/M,KAAKsC,MAE3C,OAAKyK,EAKHrJ,cAAAe,WAAA,CAAAhB,SACG2D,EAASvF,IAAI,CAACL,EAAMmD,KACnB,MAAM4C,EAAMvH,KAAKqH,WAAW7F,GAC5B,OAAK+F,EAGH7D,cAACmL,IAAM,CAELC,SAAUvH,EACVsE,QAASA,IAAM7L,KAAKiN,cAAczL,GAClCuN,KAAM/O,KAAKsN,YAHN3I,GAJQ,SAPd,IAoBX,CAEA9B,SACE,MAAM,SAAEuE,EAAQ,UAAEiB,EAAS,QAAExH,EAAO,WAAEkH,EAAU,gBAAEgF,EAAe,gBAAEH,GAAoB5M,KAAKsC,MAE5F,IAAKiG,MAAMC,QAAQpB,GAAW,OAAO,KACrC,GAAwB,IAApBA,EAAS/G,OAAc,OAAOqD,cAACK,IAAK,IAExC,MAAM0E,EAASrB,EACZvF,IAAKL,GAASxB,KAAKqH,WAAW7F,IAC9BkH,OAAQnB,GAAQA,GAEnB,GAAsB,IAAlBkB,EAAOpI,OACT,OACEqD,cAAA,OAAKF,UAAWxD,KAAKH,MAAM2D,UAAUC,SACnCC,cAACK,IAAK,MAKZ,MAAM2G,EAASjC,EAAOpI,OAAS,EAAIoI,EAAO,GAAK2D,EAE/C,OACE/I,eAAAoB,WAAA,CAAAhB,SAAA,GACK4E,GAAaxH,IAAYkM,IAAoBrJ,cAACqF,IAAgB,IAEjErF,cAACsF,IAAM,CACLC,MAAiB,OAAVlB,QAAU,IAAVA,OAAU,EAAVA,EAAYmB,MACnBC,UAAU,QACVC,QAASpJ,KAAK4H,YACdyB,QAASrJ,KAAKsC,MAAMuF,cAAcpE,SAElCC,cAAC4F,IAAgB,CAAA7F,SACfC,cAACjE,EAAmB,CAACyB,UAAqB,OAAV6G,QAAU,IAAVA,OAAU,EAAVA,EAAYtH,SAIhDiD,cAAC6F,IAAM,CAAA9F,SACLC,cAAA,SAAAD,SAAQzD,KAAKC,EAAE,gBAGjBoD,eAAA,OACEG,UAAU,iBACVsB,MAAO,CACLkK,QAAS3G,IAAcxH,GAAWkM,EAAkB,EAAI,EACxDkC,WAAY,gBACZxL,SAAA,CAEFC,cAAA,OAAKF,UAAU,YAAWC,SACxBC,cAAC+F,IAAI,CAACC,KAAK,QAAOjG,SAChBC,cAACiG,IAAW,CACV5H,MAAO/B,KAAKsC,MAAMoE,MAClBkD,YAAa5J,KAAKC,EAAE,UACpB4J,YAAcrI,GAAI,GAAA2D,OAAQ3D,EAAK0H,MAAK,KAAA/D,OAAI3D,EAAKsI,UAC7CC,YAAa,CAAC,WAAY,aAC1BC,aAAW,EACXC,SAAS,QACTC,MAAM,YACNC,SAAUA,CAACC,EAAG5I,KACZxB,KAAKH,MAAMwK,QAAQrD,KAAK,oBAAD7B,OACDiF,EAAC,KAAAjF,OAAI3D,EAAK8I,WAAa,YAOrD5G,cAACwL,IAAU,CACTT,iBAAkBzO,KAAKiI,OAAOwG,iBAC9B1I,SAAU6G,EACVuC,OAAQnP,KAAKuO,sBAAsB3B,GACnCwC,eAAgB1L,cAAA,OAAKoB,MAAO,CAAE+F,OAAQ,OAAQwE,WAAY,aAC1DtE,OAAQ/K,KAAKoO,aACbkB,QAAStP,KAAKsO,cAAc7K,SAE5BC,cAAC6L,IAAS,CACRpD,kBAAmBA,EACnBzB,OAAQA,EACRC,KAAM,EACNI,OAAQ/K,KAAKkO,UACbpC,QAAS,CACP0D,aAAa,EACbC,mBAAmB,EACnBC,gBAAgB,EAChBC,mBAAmB,EACnB5J,SAAU6G,GACVnJ,SAEDzD,KAAK4O,4BAMlB,EA1XItC,EACG7G,YAAcC,IA4XRC,kBAAWC,YAAW0G,ICpZrC,MAAMsD,UAA+BlQ,IAAMC,UAGzCC,YAAYC,GACVE,MAAMF,GAEN,MAAMqG,EAAY8B,OAAO9B,WAAa,CAAC,EAEvClG,KAAKiI,OAAS,CACZpG,IAAKqE,EAAUrE,IAEnB,CAEAgB,SACE,OACEa,cAAAe,WAAA,CAAAhB,SACuB,WAApBzD,KAAKiI,OAAOpG,IACX6B,cAACmC,EAAoB,IAErBnC,cAAC4I,EAAoB,KAI7B,EAvBIsD,EACGnK,YAAcC,IAyBRC,sBAAWC,YAAWgK,G,mCCjCrC,4GAOA,MAAM,QAAEC,GAAYC,IAEpB,MAAM3L,UAAmBzE,IAAMC,UAE7BC,YAAYC,GACVE,MAAMF,GAAO,KAOfkQ,cAAgB,KACd/P,KAAKY,SACF0B,IACQ,CACL0N,aAAc1N,EAAM0N,YACpBC,QAAU3N,EAAM0N,YAAmB1N,EAAM2N,QAAX,KAGlC,IAAMjQ,KAAKgB,SAEb,KAEFN,aAAe,KACTV,KAAKH,MAAMc,eACbX,KAAKH,MAAMc,iBAGbX,KAAKY,SAAS,CAAEC,SAAS,KACzB,KAEFC,WAAa,KACPd,KAAKH,MAAMkB,aACbf,KAAKH,MAAMkB,eAGbf,KAAKY,SAAS,CAAEC,SAAS,KACzB,KAEFG,KAAOC,UACL,GAAIjB,KAAKsC,MAAM0N,YAAa,CAC1BhQ,KAAKU,eACL,IAAIuP,QAAgBjQ,KAAKoB,QAAQC,IAAIC,EAAE,IAAD6D,OAChCnF,KAAKH,MAAMqQ,UAAS,WACxB,CAAEzP,GAAIT,KAAKH,MAAMY,IACjB,CAAEc,SAAS,IAEbvB,KAAKY,SAAS,CAAEqP,WAAW,IAAMjQ,KAAKc,aACxC,GACA,KAEFqP,IAAMlP,UACJjB,KAAKU,eACL,IAAIoB,QAAe9B,KAAKoB,QAAQC,IAAIC,EAAE,cAAe,CACnDb,GAAIT,KAAKH,MAAMY,GACf2P,OAAQA,EAAO3P,KAEjBT,KAAKc,aACLd,KAAK+P,gBACAjO,GAIHI,IAAQE,QAAQpC,KAAKC,EAAE,mBACnBD,KAAKH,MAAM0E,UACbvE,KAAKH,MAAM0E,SAAS6L,KALtBlO,IAAQC,MAAMnC,KAAKC,EAAE,gBACrBD,KAAKY,SAAS,CAAEC,SAAS,MAO3B,KAEFwP,IAAMpP,UACsB,SAAtBmP,EAAOE,WACTT,EAAQ,CACN5G,MAAOjJ,KAAKC,EAAE,wBACdsQ,QAASvQ,KAAKC,EAAE,uBAChB8O,KAAMrL,cAAC8M,IAAyB,IAChCC,KAAMA,KACJzQ,KAAKmQ,IAAIC,MAIbpQ,KAAKmQ,IAAIC,IAEX,KAEFnQ,EAAKQ,IACH,MAAM,KAAEF,GAASP,KAAKH,MACtB,OAAOU,EAAKC,cAAc,CAAEC,QAlF5BT,KAAKsC,MAAQ,CACX0N,aAAa,EACbC,QAAS,GAEb,CAiFApN,SAAU,IAAD6N,EACP,GAAe,QAAXA,EAAC1Q,KAAKH,aAAK,IAAA6Q,IAAVA,EAAYC,WAAY,OAAO,KAEpC,MAAM,QAAE9P,EAAO,QAAEoP,EAAU,IAAOjQ,KAAKsC,MASjC4G,EACJxF,cAACkN,IAAG,CAACpN,UAAU,SAASqN,MARX,CACbC,QAAS,aACTC,QAAS,UACTC,SAAU,UACVC,QAAS,SAI6BjR,KAAKH,MAAMqR,eAAezN,SAC7DzD,KAAKH,MAAM8Q,aAIhB,OAAI3Q,KAAKH,MAAMwE,SAAiB6E,EAG9BxF,cAACyN,IAAO,CACNZ,QACE7M,cAAA,OAAKF,UAAS,GAAA2B,OAAwB,IAAnB8K,EAAQ5P,QAAgB,UAAWoD,SACpDC,cAACG,IAAI,CAACC,SAAUjD,EAAQ4C,SACrBwM,EAAQpO,IAAKuO,GACPA,EAAO/G,QAEV3F,cAAA,OAEEmI,QAASA,IAAM7L,KAAKqQ,IAAID,GACxB5M,UAAU,6BAA4BC,SAErC2M,EAAOlH,OAJHkH,EAAO3P,IAHY,UAcpC2Q,QAAQ,QACRC,KAAMrR,KAAKsC,MAAM0N,YACjBsB,aAActR,KAAK+P,cAActM,SAEjCC,cAAA,OAAKF,UAAU,aAAYC,SAAEyF,KAGnC,EAxII/E,EACGsB,YAAcC,IA8IR6L,gBAAW3L,YAAWzB,GAJd,CACrBwM,WAAaa,GAAMA,EAAEC,cACrBP,cAAgBM,GAAMA,EAAEE,kB,sJClJ1B,MAAMnS,EAAS,CACboS,IAAI,EAEJnS,KAAMA,KACJD,EAAOqS,SAETC,UAAWA,KACLtS,EAAOoS,KACTpS,EAAOoS,IAAK,EACZpS,EAAOuS,SAAS,mBAChBvS,EAAOwS,IAAI,kBAGfC,SAAUA,KACHzS,EAAOoS,KACVpS,EAAOoS,IAAK,EACZpS,EAAOuS,SAAS,kBAChBvS,EAAOwS,IAAI,kBAGfD,SAAU,SAACG,GAAuB,IAAjBC,EAAM9R,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAG,CAAC,EACzB4H,OAAOmK,cAAc,IAAIC,YAAYH,EAAM,CAAEC,WAC/C,EACAN,MAAO3Q,UACL,IAAIoR,EAAQC,IAAYC,MACxB,GAAIF,EAAO,CACT,IAAIG,EAAK,IAAIrP,KACbqP,EAAGC,gBACDD,EAAGE,mBAAqBzK,IAAO0K,iBAAmB,MAGpD,MAAMC,EAAOC,KAAKC,UAAU,CAC1B/L,OAAQ,CAAC,CAAEE,MAAO,WAAYlF,MAAOyQ,EAAItL,QAAS,QAClD6L,SAAU,IACVC,QAAS,CAAC,mBAGZ,IAAIC,EAAO,KACPC,EAAW,KACXC,EAAU,IAAIC,QAClBD,EAAQE,OAAO,eAAgB,oBAC/BF,EAAQE,OAAO,gBAAgB,UAADlO,OAAYkN,IAC1C,MAAM9E,EAAG,GAAApI,OAAM8C,IAAOqL,WAASnO,OAAG8C,IAAOsL,QAAO,sBAEhD,IAQiB,IAADC,EAEKC,EAAAC,EAFnB,GAPAR,QAAiBtB,MAAMrE,EAAK,CAC1B6C,OAAQ,OACR+C,UACAP,OACAe,KAAM,OACNC,MAAO,aAELV,EAEF,GADAD,QAAaC,EAASD,OACd,QAARO,EAAIP,SAAI,IAAAO,GAAJA,EAAMrR,MACR,OAAO5C,EAAO4C,MAAU,QAALsR,EAACR,SAAI,IAAAQ,GAAO,QAAPC,EAAJD,EAAMtR,aAAK,IAAAuR,OAAP,EAAJA,EAAaxR,SAGrC3C,EAAOyS,UACT,CAAE,MAAO6B,GAEP,OADAtU,EAAOsS,YACAtS,EAAO4C,MAAM0R,EAAE3R,QACxB,CACA,GAAI+Q,EAAM,CACR,IAAIa,EAAQ,CAAC,GACZvL,MAAMC,QAAQyK,GAAQA,EAAO,CAACA,IAAOlF,QAASgG,IACxCD,EAAMC,EAAEC,UACXF,EAAMC,EAAEC,QAAUD,KAItB,IAAIE,EAAaC,OAAOC,KAAKL,GAAOzT,OAEhC4T,EAAa,IACf1U,EAAOuS,SAAS,gBAAiB,CAAEgC,UACnCvU,EAAOwS,IAAI,kBAAoBkC,GAEnC,CACA,OAAO,CACT,GAEF9R,MAAQD,IACF+F,IAAOmM,OACTzG,QAAQoE,IAAI,qBAAD5M,OAAsBjD,EAAO,KAAK,kBAExC,GAET6P,IAAM7P,IACA+F,IAAOmM,OACTzG,QAAQoE,IAAI,cAAD5M,OAAejD,GAAW,iBAS3C,SAASqP,EAAW5R,EAAW0U,GAC7B,MAAMC,EAAYJ,OAAOC,KAAKE,GAE9B,OAAO,cAAc3U,IAAMC,UACzBC,YAAYC,GACVE,MAAMF,GAAO,KAcf0U,gBAAmBV,IAAO,IAADW,EACvB,IAAIC,EAAQ,OAADZ,QAAC,IAADA,GAAS,QAARW,EAADX,EAAG3B,cAAM,IAAAsC,OAAR,EAADA,EAAWV,MAAM9T,KAAKH,MAAMY,IACnCgU,IACFzU,KAAKY,SAASoC,IAAoB,IAAnB,UAAE0R,GAAW1R,EAI1B,OAHAsR,EAAUvG,QAAS4G,IACjBD,EAAUC,GAAYN,EAAeM,GAAUF,KAE1C,CAAEC,eAGX1U,KAAKY,SAAS,CAAE6T,WAvBlBzU,KAAKsC,MAAQ,CACXmS,KAAM,CAAC,EACPC,UAAW,CAAC,EAEhB,CACAnS,oBACEyF,OAAO4M,iBAAiB,gBAAiB5U,KAAKuU,gBAChD,CAEA7F,uBACE1G,OAAO6M,oBAAoB,gBAAiB7U,KAAKuU,gBACnD,CAgBA/R,mBAAmBC,EAAWC,EAAWC,GACvC,IAAI,UAAE+R,GAAc1U,KAAKsC,MACrBwS,GAAa,EAEjBR,EAAUvG,QAAS4G,IACblS,EAAUkS,KAAc3U,KAAKH,MAAM8U,KACrCD,EAAUC,GAAY3U,KAAKH,MAAM8U,GACjCG,GAAa,KAGbA,GAAY9U,KAAKY,SAAS,CAAE8T,aAClC,CAEA7R,SACE,MAAM,UAAE6R,GAAc1U,KAAKsC,MAE3B,OAAOoB,cAAC/D,EAASyE,wBAAA,GAAKpE,KAAKH,OAAW6U,GACxC,EAEJ,EAxDK1M,OAAO+M,gBAAkB9M,IAAO0K,kBACnC3K,OAAOyE,YAAY,IAAMlN,EAAOC,OAAQyI,IAAO0K,iB,mCCnGjD,sDAKA,MAAM,OAAEqC,GAAWC,IAEnB,MAAMtL,UAAoBjK,IAAMC,UAE9BC,YAAYC,GACVE,MAAMF,GAAO,KAiBfqV,aAAe,KACb,IAAInO,EAAS/G,KAAKH,MAAMkH,QAAU,GAqBlC,OApBI/G,KAAKsC,MAAM6S,YAAcnV,KAAKH,MAAMoB,OACtC8F,EAAOC,KAAK,CACVC,MAAOjH,KAAKH,MAAMoK,UAAY,QAC9B/C,QAAS,MACTnF,MAAM,IAADoD,OAAMnF,KAAKsC,MAAM6S,WAAU,OAGhCnV,KAAKH,MAAMmK,aACbjD,EAAOC,KAAK,CACVC,MAAO,gBACPC,QAAS,MACTnF,MAAO,YAGP/B,KAAKH,MAAMuV,QACbrO,EAAOC,KAAK,CACVC,MAAO,SACPlF,MAAO/B,KAAKH,MAAMuV,SAGfrO,GACP,KAEFsO,YAAc,IAAMrV,KAAKH,MAAMoK,UAAY,QAAQ,KAEnDqL,SAAW,IAAMtV,KAAKH,MAAM0V,UAAY,KAAK,KAE7CC,eAAiBvU,UACf,GAAIjB,KAAKH,MAAMoB,QAEVjB,KAAKsC,MAAMwR,MAAM2B,KACfjU,GAASA,EAAKxB,KAAKsV,cAAgBtV,KAAKH,MAAMkC,OAEjD,CACA/B,KAAKY,SAAS,CAAEC,SAAS,IACzB,IAAIiB,QAAe9B,KAAKoB,QAAQC,IAAIC,EAAE,cAAe,CACnDb,GAAIT,KAAKH,MAAMkC,MACf2T,OAAQ,CAAC1V,KAAKsV,WAAYtV,KAAKqV,iBAEjCrV,KAAKY,SAAS,CAAEC,SAAS,IACf,OAANiB,QAAM,IAANA,KAAS9B,KAAKqV,gBAChBrV,KAAKY,SAASoC,IAAgB,IAAf,MAAE8Q,GAAO9Q,EAEtB,OADA8Q,EAAM9M,KAAKlF,GACJ,CAAEgS,UAGf,GAEF,KAEF9S,KAAOC,UACL,GAAIjB,KAAKH,MAAMiU,MAEb,YADA9T,KAAKY,SAAS,CAAEkT,MAAO9T,KAAKH,MAAMiU,QAIpC,IAAIA,EAAQ,GAERf,EAAW/S,KAAKH,MAAMoB,MAAQ,EAAI,EAEtC,GAAIjB,KAAKH,MAAMqK,MAAO,CACpBlK,KAAKY,SAAS,CAAEC,SAAS,IACzB,IAAIkG,EAAS/G,KAAKkV,eAEdQ,EAAS,CAAC1V,KAAKsV,WAAYtV,KAAKqV,eAAelQ,OACjDnF,KAAKH,MAAMkK,aAAe,IAGxB4L,EAAU3V,KAAKH,MAAM+T,MACrB5T,KAAKoB,QAAQC,IAAIuS,MACjB5T,KAAKoB,QAAQC,IAAIC,EACrBwS,QAAc6B,EACZ3V,KAAKH,MAAMqK,MACX,CAAEnD,SAAQgM,WAAU2C,UACpB,CAAEnU,SAAS,IAEbvB,KAAKY,SAAS,CAAEC,SAAS,EAAOiT,SAClC,GACA,KACF8B,SAAW3U,UACLjB,KAAKH,MAAMoB,OACbjB,KAAKY,SAAS,CAAEuU,WAAYpT,GAAS,IAAM/B,KAAKgB,SAElD,KAEFmJ,SAAYpI,IACV,IAAIP,EAAOxB,KAAKsC,MAAMwR,MAAM2B,KAAMI,GAAMA,EAAE7V,KAAKsV,cAAgBvT,GAC/D/B,KAAKH,MAAMsK,SAASpI,EAAOP,IAzG3BxB,KAAKsC,MAAQ,CACX6S,WAAY,GACZtU,SAAS,EACTiT,MAAO,GAEX,CACAvR,oBACEvC,KAAKgB,OAAO8U,KAAK9V,KAAKwV,iBACxB,CAEAhT,mBAAmBC,EAAWC,EAAWC,GACnCF,EAAUV,QAAU/B,KAAKH,MAAMkC,OACjC/B,KAAKwV,gBAET,CA8FA3S,SAEE,IAAIiR,EAAQ9T,KAAKsC,MAAMwR,MAAMjS,IAAI,CAACL,EAAMmD,KACtC,IAAIoR,EAASvU,GAAQ,CAAC,EAClBO,EAAQgU,EAAO/V,KAAKsV,YACpBpM,EAAQlJ,KAAKH,MAAMgK,YACnB7J,KAAKH,MAAMgK,YAAYrI,GACvBuU,EAAO/V,KAAKqV,eAEhB,OACE3R,cAACsR,EAAM,CAAWjT,MAAOA,EAAM0B,SAC5ByF,GADUvE,KAMjB,OACEjB,cAACuR,IAAM,CACLe,0BAA0B,EAC1BC,WAAYjW,KAAKH,MAAMoW,WACvBC,UAASlW,KAAKsC,MAAMzB,QACpBkB,MAAQ/B,KAAKsC,MAAMzB,QAA6B,KAAnBb,KAAKH,MAAMkC,MACxCoU,YAAU,EACVvM,YAAa5J,KAAKH,MAAM+J,YACxBwM,iBAAiB,WACjBjM,SAAUnK,KAAKmK,SACfyL,SAAU5V,KAAK4V,SACfS,aAAcA,CAACC,EAAOP,IACpBA,EAAOtS,SAAS8S,cAAcC,QAAQF,EAAMC,gBAAkB,EAC/D9S,SAEAqQ,GAGP,EAlJInK,EACGlE,YAAcC,IAmJRE,gBAAW+D,E,mCC3JX,SAASrB,EAAiB7F,EAAW5C,GAClD,MAAM4W,EAAahU,EAAUoE,MAAMC,QAAU,CAAC,EACxC4P,EAAY7W,EAAMgH,MAAMC,QAAU,CAAC,EAEzC,OACE2P,EAAWhQ,SAAWiQ,EAAUjQ,QAChCgQ,EAAW9P,SAAW+P,EAAU/P,QAChC8P,EAAWE,SAAWD,EAAUC,MAMpC,CAbA,+B,mCCAA,yEA0CepF,gBArCf,SAA0B1R,GACxB,IAAI+W,EAAW,CAAC,YAAYC,SAAShX,EAAMiX,WACvCC,EAAW,CAAC,YAAYF,SAAShX,EAAMiX,WAE3C,OACEzT,eAAC3D,IAAMsX,SAAQ,CAAAvT,SAAA,CACbC,cAACuT,IAAO,CAAChO,MAAOpJ,EAAMI,EAAE,cAAcwD,SACpCC,cAAC0B,IAAM,CACL5B,UAAU,UACVqI,QAAUgI,IACRA,EAAEqD,kBACFrX,EAAMmC,aAAa4U,IAErB7H,KACErL,cAACyT,IAAY,CAAC3T,UAAS,GAAA2B,OAAKyR,EAAW,kBAAoB,UAIjElT,cAACuT,IAAO,CAAChO,MAAOpJ,EAAMI,EAAE,eAAewD,SACrCC,cAAC0B,IAAM,CACLyG,QAAUgI,IACRA,EAAEqD,kBACFrX,EAAMwC,cAAc0U,IAEtBhI,KACErL,cAAC0T,IAAe,CACd5T,UAAS,GAAA2B,OAAK4R,EAAW,kBAAoB,YAO3D,EACuB,CACrBD,UAAYtF,GAAMA,EAAE6F,c","file":"static/js/9.2b824dd4.chunk.js","sourcesContent":["import React from \"react\";\nimport Context from \"../../Context\";\nimport {Link, withRouter} from \"react-router-dom\";\nimport {injectIntl} from \"react-intl\";\nimport {Button, Col, Empty, message, Row, Spin} from \"antd\";\nimport Flex from \"../../util/Flex\";\nimport Statelabel from \"../../util/Statelabel\";\nimport ConnectorButtons from \"../Connectors/ConnectorButtons\";\nimport {online} from \"../../api/online\";\n//import config from \"../../api/config\";\n\n// if (!window.onlineInterval && config.apiCheckInterval) {\n//   window.setInterval(() => online.tick(), config.apiCheckInterval);\n// }\n\nonline.tick();\n\nclass DriverStationDetail extends React.Component {\n  static contextType = Context;\n\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      detailPending: false,\n      pending: false,\n      stationId: false,\n      item: {},\n      access: {},\n      files: [],\n    };\n  }\n\n  m = (key, prefix = \"stations.\") => {\n    const {intl} = this.props;\n    return intl.formatMessage({id: prefix + key});\n  };\n\n  pendingStart = () => {\n    if (this.props.onPendingStart) {\n      this.props.onPendingStart();\n      return;\n    }\n    this.setState({pending: true});\n  };\n  pendingEnd = () => {\n    if (this.props.onPendingEnd) {\n      this.props.onPendingEnd();\n      return;\n    }\n    this.setState({pending: false});\n  };\n\n  componentDidMount() {\n    this.load();\n  }\n\n  componentDidUpdate(prevProps, prevState, snapshot) {\n    if (\n      prevProps.stationId !== this.props.stationId ||\n      prevProps.intl.locale !== this.props.intl.locale\n    ) {\n      this.setState({item: {}}, () => this.load());\n    }\n  }\n\n  load = async () => {\n    if (this.props.stationId) {\n      this.pendingStart();\n\n      let readings = [\n        await this.context.api.q(\"/charge_point/get\", {\n          id: this.props.stationId,\n        }),\n        await this.context.api.q(\"/object/access/decode\", {\n          id: this.props.stationId,\n        }),\n        await this.context.api.q(\n          \"/object/file\",\n          {\n            id: this.props.stationId,\n          },\n          {toArray: true}\n        ),\n      ];\n      let [item, access, files] = (await Promise.allSettled(readings)).map(\n        (result) => result.value\n      );\n\n      this.setState({item, access, files}, () => this.pendingEnd());\n    } else {\n      this.setState({item: {}, access: {}, files: []});\n    }\n  };\n\n  chargeToggle = async (item = {}, value) => {\n    if (item.id) {\n      this.setState({detailPending: true});\n      let result = false;\n      if (value) {\n        result = await this.context.api.q(\"/connector/remote/stop\", {\n          id: item.id,\n        });\n      } else {\n        result = await this.context.api.q(\"/connector/remote/start\", {\n          id: item.id,\n        });\n      }\n      this.setState({detailPending: false});\n      if (result === false) {\n        message.error(this.m(\"method.fail\", \"\"));\n      } else {\n        message.success(this.m(\"method.success\", \"\"));\n      }\n      await this.load();\n    }\n  };\n\n  reserveToggle = async (item = {}, value) => {\n    if (item.id) {\n      this.setState({detailPending: true});\n      let result = false;\n      if (value) {\n        result = await this.context.api.q(\"/connector/reserve/cancel\", {\n          id: item.id,\n        });\n      } else {\n        result = await this.context.api.q(\"/connector/reserve/now\", {\n          id: item.id,\n        });\n      }\n      this.setState({detailPending: false});\n      if (result === false) {\n        message.error(this.m(\"method.fail\", \"\"));\n      } else {\n        message.success(this.m(\"method.success\", \"\"));\n      }\n      await this.load();\n    }\n  };\n\n  render() {\n    const {pending, item, access, files} = this.state;\n    const connectors = item.connectors || [];\n\n    const displayDetailProps = [\n      \"identity\",\n      \"modelname\",\n      \"vendorname\",\n      \"serialnumber\",\n      \"boxserialnumber\",\n      \"iccid\",\n      \"imsi\",\n      \"networkname\",\n      \"connected\",\n      \"connectionupdate\",\n      \"lastupdate\",\n    ];\n\n    const DetailRow = ({item, property, connected}) => {\n      let value = item?.[property];\n      if (typeof value === \"string\") {\n        if (property === 'lastupdate' || property === 'created' || property === 'connectionupdate') {\n          value = new Date(value).toLocaleString();\n        }\n      } else if (typeof value === \"boolean\") {\n        value = value ? this.m(\"true\") : this.m(\"false\")\n      }\n      if (!value) return null;\n      return (\n        <Row gutter={[16, 16]} className=\"gx-mb-2\">\n          <Col className=\"gx-text-muted gx-font-weight-light gx-pr-2\" xs={10}>\n            {property === 'connectionupdate' ? connected ? this.m(property) : this.m(\"disconnected\") : this.m(property)}\n          </Col>\n          <Col xs={14}>{value}</Col>\n        </Row>\n      );\n    };\n\n    return (\n      <div>\n        <Spin spinning={pending}>\n          {!item?.id && <Empty/>}\n          {item?.id && (\n            <div className=\"gx-mb-3\">\n              {item?.description && (\n                <div className=\"gx-text-muted gx-font-weight-light gx-mb-3\">\n                  {item.description}\n                </div>\n              )}\n              <Flex between className=\"gx-mb-3 gx-pr-1\">\n                <h4>{this.m(\"details\")}</h4>\n                <Statelabel\n                  {...item}\n                  readOnly={!access?.u}\n                  onFinish={this.load}\n                />\n              </Flex>\n              {displayDetailProps.map((prop) => (\n                <DetailRow key={prop} item={item} property={prop} connected={item.connected}/>\n              ))}\n              {connectors.length > 0 && (\n                <>\n                  <Spin spinning={this.state.detailPending}>\n                    <hr/>\n                    {connectors.map((c, idx) => {\n                      return (\n                        <div className=\"gx-mb-2\" key={idx}>\n                          <Flex between>\n                            <div>\n                              {c.chargername}\n                              <div className=\"gx-font-weight-light gx-text-small gx-text-muted\">\n                                {c.chargerdescription}\n                              </div>\n                            </div>\n                            <div className=\"gx-ml-2 gx-mr-1\">\n                              <Statelabel\n                                {...c}\n                                readOnly={true}\n                                onFinish={this.load}\n                              />\n                              <div style={{whiteSpace: \"nowrap\"}}>\n                                <ConnectorButtons\n                                  m={this.m}\n                                  {...c}\n                                  chargeToggle={(value) =>\n                                    this.chargeToggle(c, value)\n                                  }\n                                  reserveToggle={(value) =>\n                                    this.reserveToggle(c, value)\n                                  }\n                                />\n                              </div>\n                            </div>\n                          </Flex>\n                        </div>\n                      );\n                    })}\n                  </Spin>\n                </>\n              )}\n              {access?.u && (\n                <Link to={`/crm/station/${item.id}`}>\n                  <Button className=\"gx-mb-0 gx-mt-4\">\n                    {this.m(\"edit\", \"\")}\n                  </Button>\n                </Link>\n              )}\n              {files.length > 0 && (\n                <>\n                  <hr/>\n                  {files.map((f, idx) => {\n                    return (\n                      <img\n                        key={idx}\n                        alt=\"\"\n                        src={f.link}\n                      />\n                    );\n                  })}\n                </>\n              )}\n            </div>\n          )}\n        </Spin>\n      </div>\n    );\n  }\n}\n\nexport default withRouter(injectIntl(DriverStationDetail));\n","import { Card, Drawer, Empty } from \"antd\";\nimport React from \"react\";\nimport { Helmet } from \"react-helmet\";\nimport { injectIntl } from \"react-intl\";\nimport { withRouter } from \"react-router-dom\";\nimport { YMaps, Map, Placemark, ZoomControl } from \"react-yandex-maps\";\nimport CircularProgress from \"../../components/CircularProgress\";\nimport Context from \"../../Context\";\nimport CustomScrollbars from \"../../util/CustomScrollbars\";\nimport paramsHasChanged from \"../../util/paramsHasChanged\";\nimport PlainSelect from \"../../util/PlainSelect\";\nimport DriverStationDetail from \"./DriverStationDetail\";\n\nclass DriverStationsYandex extends React.Component {\n  static contextType = Context;\n  constructor(props) {\n    super(props);\n\n    const appConfig = window.appConfig || {};\n\n    if (!process.env.REACT_APP_YANDEX_MAPS_API_KEY) {\n      console.error('❌ Yandex Maps API key is missing in environment variables');\n    }\n\n    this.config = {\n      ...appConfig,\n      yandexMapsApiKey: process.env.REACT_APP_YANDEX_MAPS_API_KEY,\n      mapLanguage: this.getMapLanguage(appConfig),\n      mapDefaultCenter: appConfig.mapDefaultCenter || [50.85045, 4.34878],\n    };\n\n    this.state = {\n\n      mapLoaded: false,\n      pending: false,\n      stations: [],\n\n      carId: false,\n      chargerId: false,\n\n      drawerVisible: false,\n      drawerItem: {},\n    };\n  }\n\n  getYandexLanguage = (language) => {\n    const codeMap = {\n      'ru': 'ru_RU',\n      'en': 'en_US',\n      'de': 'de_DE',\n      'fr': 'fr_FR',\n      'it': 'it_IT',\n    };\n\n    return codeMap[language] || language.toUpperCase();\n  };\n\n  getMapLanguage = (appConfig) => {\n    const storedLanguage = localStorage.getItem(\"ocppcsDefaultLanguage\");\n    const defaultLanguage = appConfig.mapLanguage || appConfig.defaultLanguage;\n    return this.getYandexLanguage(storedLanguage ? storedLanguage : defaultLanguage);\n  }\n\n  pendingStart = () => {\n    if (this.props.onPendingStart) {\n      this.props.onPendingStart();\n      return;\n    }\n    this.setState({ pending: true });\n  };\n\n  pendingEnd = () => {\n    if (this.props.onPendingEnd) {\n      this.props.onPendingEnd();\n      return;\n    }\n    this.setState({ pending: false });\n  };\n\n  m = (key, prefix = \"stations.map.\") => {\n    const { intl } = this.props;\n    return intl.formatMessage({ id: prefix + key });\n  };\n\n  componentDidMount() {\n    this.setParams();\n    this.load();\n  }\n\n  componentDidUpdate(prevProps, prevState, snapshot) {\n    if (paramsHasChanged(prevProps, this.props)) {\n      this.setParams();\n    }\n    if (prevProps.intl.locale !== this.props.intl.locale) {\n      this.load();\n    }\n  }\n\n  setParams = () => {\n    const { param1: carId, param2: chargerId } = this.props.match.params;\n    this.setState(\n      {\n        carId,\n        chargerId,\n      },\n      () => this.load()\n    );\n  };\n\n  load = async () => {\n    this.pendingStart();\n\n    let search = [];\n    if (this.state.chargerId) {\n      search.push({\n        field: \"connectors\",\n        compare: \"GIN\",\n        value: [{ charger: this.state.chargerId }],\n      });\n    }\n\n    let stations = await this.context.api.q(\n      \"/charge_point/list\",\n      { search },\n      { toArray: true }\n    );\n\n    this.setState({ stations }, () => this.pendingEnd());\n  };\n\n  getItemGeo = (item) => {\n    let geo = item?.geo?.[0] || {};\n    let lat = geo.latitude;\n    let lng = geo.longitude;\n    if (lat && lng) {\n      return [lat, lng];\n    }\n    return null;\n  };\n\n  drawerClose = () => {\n    this.setState({ drawerVisible: false });\n  };\n\n  onPlacemarkClick = (drawerItem) => {\n    this.setState({ drawerItem, drawerVisible: true });\n  };\n\n  render() {\n    const { stations, mapLoaded, pending, drawerItem } = this.state;\n\n    if (!Array.isArray(stations)) return null;\n\n    if (stations.length === 0) return <Empty />;\n\n    const points = stations\n      .map((item) => this.getItemGeo(item))\n      .filter((geo) => geo);\n    if (points.length === 0) {\n      return (\n        <div className={this.props.className}>\n          <Empty />\n        </div>\n      );\n    }\n\n    const mapRef = React.createRef();\n\n    const lang = this.getMapLanguage(this.config);\n    const apikey = this.config.yandexMapsApiKey;\n    const mapDefaultCenter = this.config.mapDefaultCenter;\n\n    return (\n      <>\n        {(!mapLoaded || pending) && <CircularProgress />}\n        <Drawer\n          title={drawerItem?.label}\n          placement=\"right\"\n          onClose={this.drawerClose}\n          visible={this.state.drawerVisible}\n        >\n          <CustomScrollbars>\n            <DriverStationDetail stationId={drawerItem?.id} />\n          </CustomScrollbars>\n        </Drawer>\n        <Helmet>\n          <title>{this.m(\"stations\")}</title>\n        </Helmet>\n        <div\n          className=\"gx-st-map huge\"\n          style={{ visibility: mapLoaded && !pending ? \"visible\" : \"hidden\" }}\n        >\n          <div className=\"filterbox\">\n            <Card size=\"small\">\n              <PlainSelect\n                value={this.state.carId}\n                placeholder={this.m(\"forcar\")}\n                formatLabel={(item) => `${item.label} ${item.identity}`}\n                extraFields={[\"identity\", \"chargerac\"]}\n                enabledOnly\n                labelKey=\"label\"\n                query=\"/car/list\"\n                onChange={(v, item) => {\n\n                  this.props.history.push(\n                    `/driver/stations/${v}/${item.chargerac || \"\"}`\n                  );\n                }}\n              />\n            </Card>\n          </div>\n\n          <YMaps key={lang} query={{ apikey, lang }}>\n            <Map\n              defaultState={{ center: points[0] || mapDefaultCenter, zoom: 9 }}\n              width={\"100%\"}\n              height={\"100%\"}\n              modules={[\"geoObject.addon.balloon\", \"util.bounds\"]}\n              onLoad={(maps) => {\n                this.setState({ mapLoaded: true });\n                if (points.length > 1) {\n                  mapRef.current.setBounds(\n                    maps.util.bounds.fromPoints(points)\n                  );\n                }\n              }}\n              instanceRef={(ref) => {\n                if (ref) {\n                  mapRef.current = ref;\n                }\n              }}\n            >\n              {stations.length !== 0 ? stations.map((item, idx) => {\n                let geo = this.getItemGeo(item);\n                if (!geo) return null;\n\n                let balloonContent = [];\n                if (item.description)\n                  balloonContent.push(`<div>${item.description || \"\"}</div>`);\n                if (item.modelname)\n                  balloonContent.push(\n                    `<div>${item.modelname || \"\"} ${\n                      item.vendorname || \"\"\n                    }</div>`\n                  );\n\n                return (\n                  <Placemark\n                    key={idx}\n                    defaultGeometry={geo}\n                    onClick={() => this.onPlacemarkClick(item)}\n                    options={{\n                      iconLayout: \"default#image\",\n                      iconImageHref: item.connected ? \"/assets/images/flash-green.png\" : \"/assets/images/flash-red.png\",\n                      iconImageSize: [32, 32],\n                    }}\n                  />\n                );\n              }) : []}\n              <ZoomControl />\n            </Map>\n          </YMaps>\n        </div>\n      </>\n    );\n  }\n}\n\nexport default withRouter(injectIntl(DriverStationsYandex));\n","import { Card, Drawer, Empty } from \"antd\";\nimport React from \"react\";\nimport { Helmet } from \"react-helmet\";\nimport { injectIntl } from \"react-intl\";\nimport { withRouter } from \"react-router-dom\";\nimport { LoadScript, GoogleMap, Marker } from \"@react-google-maps/api\";\nimport CircularProgress from \"../../components/CircularProgress\";\nimport Context from \"../../Context\";\nimport CustomScrollbars from \"../../util/CustomScrollbars\";\nimport paramsHasChanged from \"../../util/paramsHasChanged\";\nimport PlainSelect from \"../../util/PlainSelect\";\nimport DriverStationDetail from \"./DriverStationDetail\";\n\n// Конфигурация карты\nconst mapContainerStyle = {\n  width: \"100%\",\n  height: \"100%\",\n};\n\nconst defaultCenter = {\n  lat: 50.85045,\n  lng: 4.34878,\n};\n\n// Размер иконки вынесен в константу\nconst markerIconConfig = {\n  url: \"/assets/images/flash-green.png\",\n  size: { width: 32, height: 32 }\n};\n\nclass DriverStationsGoogle extends React.Component {\n  static contextType = Context;\n\n  constructor(props) {\n    super(props);\n\n    const appConfig = window.appConfig || {};\n\n    const storedLanguage = localStorage.getItem(\"ocppcsDefaultLanguage\");\n    const defaultLanguage = appConfig.mapLanguage || appConfig.defaultLanguage;\n    let loadLanguage = storedLanguage ? storedLanguage : defaultLanguage;\n\n    this.config = {\n      ...appConfig,\n      googleMapsApiKey: process.env.REACT_APP_GOOGLE_MAPS_API_KEY,\n      mapLanguage: loadLanguage\n    };\n\n    this.state = {\n      mapLoaded: false,\n      googleMapsReady: false,\n      loadError: null,\n      pending: false,\n      stations: [],\n      map: null,\n\n      carId: false,\n      chargerId: false,\n\n      drawerVisible: false,\n      drawerItem: {},\n\n      currentLanguage: loadLanguage,\n    };\n\n    this.markerIcon = null;\n  }\n\n  pendingStart = () => {\n    if (this.props.onPendingStart) {\n      this.props.onPendingStart();\n      return;\n    }\n    this.setState({ pending: true });\n  };\n\n  pendingEnd = () => {\n    if (this.props.onPendingEnd) {\n      this.props.onPendingEnd();\n      return;\n    }\n    this.setState({ pending: false });\n  };\n\n  m = (key, prefix = \"stations.map.\") => {\n    const { intl } = this.props;\n    return intl.formatMessage({ id: prefix + key });\n  };\n\n  componentDidMount() {\n    this.setParams();\n    this.load();\n    this.startLanguagePolling();\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    if (paramsHasChanged(prevProps, this.props)) {\n      this.setParams();\n    }\n\n    if (prevProps.intl.locale !== this.props.intl.locale) {\n      this.handleLanguageChange();\n    }\n\n    // Создаем иконку когда Google Maps API загружен\n    if (this.state.googleMapsReady && !prevState.googleMapsReady && !this.markerIcon) {\n      this.createMarkerIcon();\n    }\n  }\n\n  componentWillUnmount() {\n    if (this.languageCheckInterval) {\n      clearInterval(this.languageCheckInterval);\n    }\n  }\n\n  // Отслеживание изменений языка в localStorage\n  startLanguagePolling = () => {\n    this.languageCheckInterval = setInterval(() => {\n      this.checkLanguageChange();\n    }, 1000);\n  };\n\n  checkLanguageChange = () => {\n    const storedLanguage = localStorage.getItem(\"ocppcsDefaultLanguage\");\n    const appConfig = window.appConfig || {};\n    const defaultLanguage = appConfig.mapLanguage || appConfig.defaultLanguage;\n    const newLanguage = storedLanguage ? storedLanguage : defaultLanguage;\n\n    if (newLanguage !== this.state.currentLanguage) {\n      this.handleLanguageChange(newLanguage);\n    }\n  };\n\n  handleLanguageChange = (newLanguage = null) => {\n    const storedLanguage = localStorage.getItem(\"ocppcsDefaultLanguage\");\n    const appConfig = window.appConfig || {};\n    const defaultLanguage = appConfig.mapLanguage || appConfig.defaultLanguage;\n    const actualNewLanguage = newLanguage || storedLanguage || defaultLanguage;\n\n    if (actualNewLanguage !== this.state.currentLanguage) {\n\n      this.setState({\n        currentLanguage: actualNewLanguage,\n        googleMapsReady: false,\n        mapLoaded: false,\n      });\n\n      this.config.mapLanguage = actualNewLanguage;\n    }\n  };\n\n  setParams = () => {\n    const { param1: carId, param2: chargerId } = this.props.match.params;\n    this.setState(\n      {\n        carId,\n        chargerId,\n      },\n      () => this.load()\n    );\n  };\n\n  load = async () => {\n    this.pendingStart();\n\n    let search = [];\n    if (this.state.chargerId) {\n      search.push({\n        field: \"connectors\",\n        compare: \"GIN\",\n        value: [{ charger: this.state.chargerId }],\n      });\n    }\n    let stations = await this.context.api.q(\n      \"/charge_point/list\",\n      { search },\n      { toArray: true }\n    );\n    this.setState({ stations }, () => this.pendingEnd());\n  };\n\n  getItemGeo = (item) => {\n    let geo = item?.geo?.[0] || {};\n    let lat = geo.latitude;\n    let lng = geo.longitude;\n    if (lat && lng) {\n      return { lat: parseFloat(lat), lng: parseFloat(lng) };\n    }\n    return null;\n  };\n\n  drawerClose = () => {\n    this.setState({\n      drawerVisible: false\n    });\n  };\n\n  onMarkerClick = (station) => {\n    this.setState({\n      drawerItem: station,\n      drawerVisible: true\n    });\n  };\n\n  createMarkerIcon = () => {\n    if (window.google && window.google.maps && window.google.maps.Size) {\n      this.markerIcon = {\n        url: markerIconConfig.url,\n        scaledSize: new window.google.maps.Size(\n          markerIconConfig.size.width,\n          markerIconConfig.size.height\n        ),\n      };\n    }\n  };\n\n  fitBounds = (map, points) => {\n    if (!window.google || !window.google.maps || !window.google.maps.LatLngBounds) {\n      console.warn('Google Maps API not yet loaded');\n      return;\n    }\n\n    if (points.length === 0) return;\n\n    if (points.length === 1) {\n      map.setCenter(points[0]);\n      map.setZoom(12);\n      return;\n    }\n\n    const bounds = new window.google.maps.LatLngBounds();\n    points.forEach(point => {\n      bounds.extend(point);\n    });\n    map.fitBounds(bounds);\n  };\n\n  onMapLoad = (map) => {\n    this.setState({\n      mapLoaded: true,\n      map\n    });\n\n    const { stations } = this.state;\n    const points = stations\n      .map((item) => this.getItemGeo(item))\n      .filter((geo) => geo);\n\n    if (points.length > 0) {\n      setTimeout(() => {\n        if (map && window.google && window.google.maps) {\n          this.fitBounds(map, points);\n        }\n      }, 1000);\n    }\n  };\n\n  onScriptLoad = () => {\n    this.setState({\n      googleMapsReady: true,\n      loadError: null\n    });\n    this.createMarkerIcon();\n  };\n\n  onScriptError = (error) => {\n    console.error(\"❌ Error loading Google Maps script:\", error);\n    this.setState({\n      googleMapsReady: true,\n      loadError: error\n    });\n  };\n\n  // Вспомогательный метод для определения региона по языку\n  getRegionFromLanguage = (language) => {\n    const regionMap = {\n      'ru': 'RU',\n      'en': 'US',\n      'de': 'DE',\n      'fr': 'FR',\n      'es': 'ES',\n      'zh': 'CN',\n      'ja': 'JP',\n      'ko': 'KR'\n    };\n    return regionMap[language] || language.toUpperCase();\n  };\n\n  // Безопасный рендеринг контента карты\n  renderMapContent() {\n    const { stations, googleMapsReady } = this.state;\n\n    if (!googleMapsReady) {\n      return null;\n    }\n\n    return (\n      <>\n        {stations.map((item, idx) => {\n          const geo = this.getItemGeo(item);\n          if (!geo) return null;\n\n          return (\n            <Marker\n              key={idx}\n              position={geo}\n              onClick={() => this.onMarkerClick(item)}\n              icon={this.markerIcon}\n            />\n          );\n        })}\n      </>\n    );\n  }\n\n  render() {\n    const { stations, mapLoaded, pending, drawerItem, googleMapsReady, currentLanguage } = this.state;\n\n    if (!Array.isArray(stations)) return null;\n    if (stations.length === 0) return <Empty />;\n\n    const points = stations\n      .map((item) => this.getItemGeo(item))\n      .filter((geo) => geo);\n\n    if (points.length === 0) {\n      return (\n        <div className={this.props.className}>\n          <Empty />\n        </div>\n      );\n    }\n\n    const center = points.length > 0 ? points[0] : defaultCenter;\n\n    return (\n      <>\n        {(!mapLoaded || pending || !googleMapsReady) && <CircularProgress />}\n\n        <Drawer\n          title={drawerItem?.label}\n          placement=\"right\"\n          onClose={this.drawerClose}\n          visible={this.state.drawerVisible}\n        >\n          <CustomScrollbars>\n            <DriverStationDetail stationId={drawerItem?.id} />\n          </CustomScrollbars>\n        </Drawer>\n\n        <Helmet>\n          <title>{this.m(\"stations\")}</title>\n        </Helmet>\n\n        <div\n          className=\"gx-st-map huge\"\n          style={{\n            opacity: mapLoaded && !pending && googleMapsReady ? 1 : 0,\n            transition: 'opacity 0.3s'\n          }}\n        >\n          <div className=\"filterbox\">\n            <Card size=\"small\">\n              <PlainSelect\n                value={this.state.carId}\n                placeholder={this.m(\"forcar\")}\n                formatLabel={(item) => `${item.label} ${item.identity}`}\n                extraFields={[\"identity\", \"chargerac\"]}\n                enabledOnly\n                labelKey=\"label\"\n                query=\"/car/list\"\n                onChange={(v, item) => {\n                  this.props.history.push(\n                    `/driver/stations/${v}/${item.chargerac || \"\"}`\n                  );\n                }}\n              />\n            </Card>\n          </div>\n\n          <LoadScript\n            googleMapsApiKey={this.config.googleMapsApiKey}\n            language={currentLanguage}\n            region={this.getRegionFromLanguage(currentLanguage)}\n            loadingElement={<div style={{ height: '100%', background: '#f0f0f0' }} />}\n            onLoad={this.onScriptLoad}\n            onError={this.onScriptError}\n          >\n            <GoogleMap\n              mapContainerStyle={mapContainerStyle}\n              center={center}\n              zoom={9}\n              onLoad={this.onMapLoad}\n              options={{\n                zoomControl: true,\n                streetViewControl: false,\n                mapTypeControl: false,\n                fullscreenControl: true,\n                language: currentLanguage,\n              }}\n            >\n              {this.renderMapContent()}\n            </GoogleMap>\n          </LoadScript>\n        </div>\n      </>\n    );\n  }\n}\n\nexport default withRouter(injectIntl(DriverStationsGoogle));\n","import React from \"react\";\nimport Context from \"../../Context\";\nimport {withRouter} from \"react-router-dom\";\nimport {injectIntl} from \"react-intl\";\nimport DriverStationsYandex from \"./DriverStationsYandex\";\nimport DriverStationsGoogle from \"./DriverStationsGoogle\";\n\nclass DriverStationsProvider extends React.Component {\n  static contextType = Context;\n\n  constructor(props) {\n    super(props);\n\n    const appConfig = window.appConfig || {};\n\n    this.config = {\n      map: appConfig.map,\n    };\n  }\n\n  render() {\n    return (\n      <>\n        {this.config.map === \"yandex\" ? (\n          <DriverStationsYandex/>\n        ) : (\n          <DriverStationsGoogle/>\n        )}\n      </>\n    );\n  }\n}\n\nexport default withRouter(injectIntl(DriverStationsProvider));\n","import { message, Popover, Spin, Tag, Modal } from \"antd\";\nimport { injectIntl } from \"react-intl\";\nimport React from \"react\";\nimport Context from \"../Context\";\nimport { ExclamationCircleOutlined } from \"@ant-design/icons\";\nimport { withOnline } from \"../api/online\";\n\nconst { confirm } = Modal;\n\nclass Statelabel extends React.Component {\n  static contextType = Context;\n  constructor(props) {\n    super(props);\n    this.state = {\n      popoverOpen: false,\n      methods: [],\n    };\n  }\n\n  popoverToggle = () => {\n    this.setState(\n      (state) => {\n        return {\n          popoverOpen: !state.popoverOpen,\n          methods: !state.popoverOpen ? [] : state.methods,\n        };\n      },\n      () => this.load()\n    );\n  };\n\n  pendingStart = () => {\n    if (this.props.onPendingStart) {\n      this.props.onPendingStart();\n      return;\n    }\n    this.setState({ pending: true });\n  };\n\n  pendingEnd = () => {\n    if (this.props.onPendingEnd) {\n      this.props.onPendingEnd();\n      return;\n    }\n    this.setState({ pending: false });\n  };\n\n  load = async () => {\n    if (this.state.popoverOpen) {\n      this.pendingStart();\n      let methods = await this.context.api.q(\n        `/${this.props.classcode}/method`,\n        { id: this.props.id },\n        { toArray: true }\n      );\n      this.setState({ methods }, () => this.pendingEnd());\n    }\n  };\n\n  run = async (method) => {\n    this.pendingStart();\n    let result = await this.context.api.q(\"/method/run\", {\n      id: this.props.id,\n      method: method.id,\n    });\n    this.pendingEnd();\n    this.popoverToggle();\n    if (!result) {\n      message.error(this.m(\"method.fail\"));\n      this.setState({ pending: false });\n    } else {\n      message.success(this.m(\"method.success\"));\n      if (this.props.onFinish) {\n        this.props.onFinish(method);\n      }\n    }\n  };\n\n  ask = async (method) => {\n    if (method.actioncode === \"drop\") {\n      confirm({\n        title: this.m(\"method.confirm.title\"),\n        content: this.m(\"method.confirm.text\"),\n        icon: <ExclamationCircleOutlined />,\n        onOk: () => {\n          this.run(method);\n        },\n      });\n    } else {\n      this.run(method);\n    }\n  };\n\n  m = (id) => {\n    const { intl } = this.props;\n    return intl.formatMessage({ id });\n  };\n\n  render() {\n    if (!this.props?.statelabel) return null;\n\n    const { pending, methods = [] } = this.state;\n\n    const colors = {\n      created: \"processing\",\n      enabled: \"success\",\n      disabled: \"default\",\n      deleted: \"error\",\n    };\n\n    const label = (\n      <Tag className=\"gx-m-0\" color={colors[this.props.statetypecode]}>\n        {this.props.statelabel}\n      </Tag>\n    );\n\n    if (this.props.readOnly) return label;\n\n    return (\n      <Popover\n        content={\n          <div className={`${methods.length === 0 && \"gx-p-3\"}`}>\n            <Spin spinning={pending}>\n              {methods.map((method) => {\n                if (!method.visible) return null;\n                return (\n                  <div\n                    key={method.id}\n                    onClick={() => this.ask(method)}\n                    className=\"gx-my-2 gx-pointer gx-link\"\n                  >\n                    {method.label}\n                  </div>\n                );\n              })}\n            </Spin>\n          </div>\n        }\n        trigger=\"click\"\n        open={this.state.popoverOpen}\n        onOpenChange={this.popoverToggle}\n      >\n        <div className=\"gx-pointer\">{label}</div>\n      </Popover>\n    );\n  }\n}\n\nconst mapOnlineProps = {\n  statelabel: (d) => d.statenewlabel,\n  statetypecode: (d) => d.statenewtypecode,\n};\nexport default withOnline(injectIntl(Statelabel), mapOnlineProps);\n","import React from \"react\";\nimport config from \"./config\";\nimport accessToken from \"./token\";\n\nconst online = {\n  is: false,\n\n  tick: () => {\n    online.fetch();\n  },\n  goOffline: () => {\n    if (online.is) {\n      online.is = false;\n      online.dispatch(\"onlineGoOffline\");\n      online.log(\"Went offline\");\n    }\n  },\n  goOnline: () => {\n    if (!online.is) {\n      online.is = true;\n      online.dispatch(\"onlineGoOnline\");\n      online.log(\"Back On Line\");\n    }\n  },\n  dispatch: (type, detail = {}) => {\n    window.dispatchEvent(new CustomEvent(type, { detail }));\n  },\n  fetch: async () => {\n    let token = accessToken.get();\n    if (token) {\n      let dt = new Date();\n      dt.setMilliseconds(\n        dt.getMilliseconds() - (config.apiCheckInterval + 5000)\n      );\n\n      const body = JSON.stringify({\n        search: [{ field: \"datetime\", value: dt, compare: \"GEQ\" }],\n        reclimit: 500,\n        orderby: [\"datetime DESC\"],\n      });\n\n      let json = null;\n      let response = null;\n      let headers = new Headers();\n      headers.append(\"Content-Type\", \"application/json\");\n      headers.append(\"Authorization\", `Bearer ${token}`);\n      const url = `${config.apiDomain}${config.apiPath}/notification/list`;\n\n      try {\n        response = await fetch(url, {\n          method: \"POST\",\n          headers,\n          body,\n          mode: \"cors\",\n          cache: \"no-store\",\n        });\n        if (response) {\n          json = await response.json();\n          if (json?.error) {\n            return online.error(json?.error?.message);\n          }\n        }\n        online.goOnline();\n      } catch (e) {\n        online.goOffline();\n        return online.error(e.message);\n      }\n      if (json) {\n        let items = {};\n        (Array.isArray(json) ? json : [json]).forEach((n) => {\n          if (!items[n.object]) {\n            items[n.object] = n;\n          }\n        });\n\n        let itemsCount = Object.keys(items).length;\n\n        if (itemsCount > 0) {\n          online.dispatch(\"onlineChanged\", { items });\n          online.log(\"messages count \" + itemsCount);\n        }\n      }\n      return false;\n    }\n  },\n  error: (message) => {\n    if (config.debug) {\n      console.log(`%c OnLine: ERROR \"${message}\"`, \"color: orange\");\n    }\n    return false;\n  },\n  log: (message) => {\n    if (config.debug) {\n      console.log(`%c OnLine: ${message}`, \"color: cyan\");\n    }\n  },\n};\n\nif (!window.onlineInterval && config.apiCheckInterval) {\n  window.setInterval(() => online.tick(), config.apiCheckInterval);\n}\n\nfunction withOnline(Component, mapOnlineProps) {\n  const propsKeys = Object.keys(mapOnlineProps);\n\n  return class extends React.Component {\n    constructor(props) {\n      super(props);\n      this.state = {\n        data: {},\n        passProps: {},\n      };\n    }\n    componentDidMount() {\n      window.addEventListener(\"onlineChanged\", this.onOnlineChanged);\n    }\n\n    componentWillUnmount() {\n      window.removeEventListener(\"onlineChanged\", this.onOnlineChanged);\n    }\n\n    onOnlineChanged = (e) => {\n      let data = e?.detail?.items[this.props.id];\n      if (data) {\n        this.setState(({ passProps }) => {\n          propsKeys.forEach((propName) => {\n            passProps[propName] = mapOnlineProps[propName](data);\n          });\n          return { passProps };\n        });\n\n        this.setState({ data });\n      }\n    };\n\n    componentDidUpdate(prevProps, prevState, snapshot) {\n      let { passProps } = this.state;\n      let anyChanges = false;\n\n      propsKeys.forEach((propName) => {\n        if (prevProps[propName] !== this.props[propName]) {\n          passProps[propName] = this.props[propName];\n          anyChanges = true;\n        }\n      });\n      if (anyChanges) this.setState({ passProps });\n    }\n\n    render() {\n      const { passProps } = this.state;\n\n      return <Component {...this.props} {...passProps} />;\n    }\n  };\n}\n\nexport { online, withOnline };\n","import React from \"react\";\nimport { injectIntl } from \"react-intl\";\nimport { Select } from \"antd\";\nimport Context from \"../Context\";\n\nconst { Option } = Select;\n\nclass PlainSelect extends React.Component {\n  static contextType = Context;\n  constructor(props) {\n    super(props);\n    this.state = {\n      searchText: \"\",\n      pending: false,\n      items: [],\n    };\n  }\n  componentDidMount() {\n    this.load().then(this.shureHaveValue());\n  }\n\n  componentDidUpdate(prevProps, prevState, snapshot) {\n    if (prevProps.value !== this.props.value) {\n      this.shureHaveValue();\n    }\n  }\n\n  createSearch = () => {\n    let search = this.props.search || [];\n    if (this.state.searchText && this.props.async) {\n      search.push({\n        field: this.props.labelKey || \"label\",\n        compare: \"IKE\",\n        value: `%${this.state.searchText}%`,\n      });\n    }\n    if (this.props.enabledOnly) {\n      search.push({\n        field: \"statetypecode\",\n        compare: \"EQL\",\n        value: \"enabled\",\n      });\n    }\n    if (this.props.client) {\n      search.push({\n        field: \"client\",\n        value: this.props.client\n      });\n    }\n    return search;\n  };\n\n  getLabelKey = () => this.props.labelKey || \"label\";\n\n  getIdKey = () => this.props.valueKey || \"id\";\n\n  shureHaveValue = async () => {\n    if (this.props.async) {\n      if (\n        !this.state.items.find(\n          (item) => item[this.getIdKey()] === this.props.value\n        )\n      ) {\n        this.setState({ pending: true });\n        let result = await this.context.api.q(\"/object/get\", {\n          id: this.props.value,\n          fields: [this.getIdKey(), this.getLabelKey()],\n        });\n        this.setState({ pending: false });\n        if (result?.[this.getLabelKey()]) {\n          this.setState(({ items }) => {\n            items.push(result);\n            return { items };\n          });\n        }\n      }\n    }\n  };\n\n  load = async () => {\n    if (this.props.items) {\n      this.setState({ items: this.props.items });\n      return;\n    }\n\n    let items = [];\n\n    let reclimit = this.props.async ? 1 : 0;\n\n    if (this.props.query) {\n      this.setState({ pending: true });\n      let search = this.createSearch();\n\n      let fields = [this.getIdKey(), this.getLabelKey()].concat(\n        this.props.extraFields || []\n      );\n\n      let fetchFn = this.props.cache\n        ? this.context.api.cache\n        : this.context.api.q;\n      items = await fetchFn(\n        this.props.query,\n        { search, reclimit, fields },\n        { toArray: true }\n      );\n      this.setState({ pending: false, items });\n    }\n  };\n  onSearch = async (value) => {\n    if (this.props.async) {\n      this.setState({ searchText: value }, () => this.load());\n    }\n  };\n\n  onChange = (value) => {\n    let item = this.state.items.find((i) => i[this.getIdKey()] === value);\n    this.props.onChange(value, item);\n  };\n\n  render() {\n    //let valueRendered = false;\n    let items = this.state.items.map((item, idx) => {\n      let option = item || {};\n      let value = option[this.getIdKey()];\n      let label = this.props.formatLabel\n        ? this.props.formatLabel(item)\n        : option[this.getLabelKey()];\n      //if (value === this.props.value) valueRendered = true;\n      return (\n        <Option key={idx} value={value}>\n          {label}\n        </Option>\n      );\n    });\n\n    return (\n      <Select\n        defaultActiveFirstOption={false}\n        allowClear={this.props.allowClear}\n        loading={this.state.pending ? true : false}\n        value={!this.state.pending ? this.props.value : null}\n        showSearch\n        placeholder={this.props.placeholder}\n        optionFilterProp=\"children\"\n        onChange={this.onChange}\n        onSearch={this.onSearch}\n        filterOption={(input, option) =>\n          option.children.toLowerCase().indexOf(input.toLowerCase()) >= 0\n        }\n      >\n        {items}\n      </Select>\n    );\n  }\n}\nexport default injectIntl(PlainSelect);\n","export default function paramsHasChanged(prevProps, props) {\n  const prevParams = prevProps.match.params || {};\n  const nowParams = props.match.params || {};\n\n  if (\n    prevParams.param1 !== nowParams.param1 ||\n    prevParams.param2 !== nowParams.param2 ||\n    prevParams.param3 !== nowParams.param3\n  ) {\n    return true;\n  }\n\n  return false;\n}\n","import { FallOutlined, HistoryOutlined } from \"@ant-design/icons\";\nimport { Button, Tooltip } from \"antd\";\nimport React from \"react\";\nimport { withOnline } from \"../../api/online\";\n\nfunction ConnectorButtons(props) {\n  let charging = [\"charging\"].includes(props.statecode);\n  let reserved = [\"reserved\"].includes(props.statecode);\n\n  return (\n    <React.Fragment>\n      <Tooltip title={props.m(\"btn.charge\")}>\n        <Button\n          className=\"gx-mr-1\"\n          onClick={(e) => {\n            e.stopPropagation();\n            props.chargeToggle(charging);\n          }}\n          icon={\n            <FallOutlined className={`${charging ? \"gx-text-warning\" : \"\"}`} />\n          }\n        />\n      </Tooltip>\n      <Tooltip title={props.m(\"btn.reserve\")}>\n        <Button\n          onClick={(e) => {\n            e.stopPropagation();\n            props.reserveToggle(reserved);\n          }}\n          icon={\n            <HistoryOutlined\n              className={`${reserved ? \"gx-text-warning\" : \"\"}`}\n            />\n          }\n        />\n      </Tooltip>\n    </React.Fragment>\n  );\n}\nconst mapOnlineProps = {\n  statecode: (d) => d.statenewcode,\n};\nexport default withOnline(ConnectorButtons, mapOnlineProps);\n"],"sourceRoot":""}