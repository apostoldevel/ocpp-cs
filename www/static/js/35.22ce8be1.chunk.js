(this["webpackJsonpocpp-cs"]=this["webpackJsonpocpp-cs"]||[]).push([[35],{1127:function(e,t,s){"use strict";s.r(t);var a=s(0),i=s.n(a),n=s(627),r=s(172),o=s(41),c=s(389),h=s(764),d=s(142),l=s(127),p=s(716),m=s(1094),j=s(652),u=s(100),b=s(638),x=s(611),g=s(637),O=s(682),S=s(2),y=s(595),f=s(604),v=s(693),N=s(599),T=s(761),P=s(3);const{TextArea:C}=y.a;class I extends i.a.Component{constructor(e){super(e),this.pendingStart=()=>{this.props.onPendingStart?this.props.onPendingStart():this.setState({pending:!0})},this.pendingEnd=()=>{this.props.onPendingEnd?this.props.onPendingEnd():this.setState({pending:!1})},this.load=async()=>{const{itemId:e}=this.props,t=Object(n.a)();let s=!1;if(e&&"add"!==e){this.pendingStart();let e={},a=await this.context.api.q("/resource/get",{id:this.props.itemId});!1!==a&&a.id?e=a:s=!0,this.setState({item:e,notFound:s,formKey:t},()=>this.pendingEnd())}"add"===e&&this.setState({item:{node:this.props.nodeId},notFound:s,formKey:t})},this.save=async e=>{this.setState({savePending:!0});const{itemId:t,intl:s}=this.props;let a=Object(S.a)(Object(S.a)({},e),{},{node:e.node||null,id:t&&"add"!==t?t:null}),i=await this.context.api.q("/resource/set",a);this.setState({savePending:!1}),!1===i?c.b.error(s.formatMessage({id:"save.fail"})):(c.b.success(s.formatMessage({id:"save.success"})),this.props.onChange&&this.props.onChange(),"add"===t&&i.id?this.props.history.push("/admin/resource/".concat(i.id,"/")):this.load())},this.m=e=>{const{intl:t}=this.props;return t.formatMessage({id:"admin.resource."+e})},this.state={formKey:Object(n.a)(),savePending:!1,pending:!1,item:{},notFound:!1}}componentDidMount(){this.load()}componentDidUpdate(e,t,s){e.itemId!==this.props.itemId&&this.load(),e.intl.locale!==this.props.intl.locale&&this.load()}render(){const{savePending:e,pending:t,notFound:s,item:a,formKey:i}=this.state,{intl:n,itemId:r}=this.props;return s?Object(P.jsx)(f.a,{type:"error",message:n.formatMessage({id:"nothing.found"})}):Object(P.jsx)(P.Fragment,{children:r&&Object(P.jsx)(v.a,{spinning:!!t,children:Object(P.jsx)(N.a,{layout:"vertical",name:"profile",initialValues:{name:a.name||"",description:a.description||"",data:a.data||"",node:a.node||"",type:a.type||"",sequence:a.sequence||!1},onFinish:this.save,onFinishFailed:this.onFormFinishFailed,children:Object(P.jsxs)(h.b,{direction:"vertical",style:{width:"100%"},children:[Object(P.jsx)(N.a.Item,{label:this.m("node"),name:"node",children:Object(P.jsx)(T.a,{parentKey:"node",treeDefaultExpandAll:!0,query:"/resource/list",allowClear:!0})}),Object(P.jsx)(N.a.Item,{rules:[{required:!0}],label:this.m("name"),name:"name",children:Object(P.jsx)(y.a,{})}),Object(P.jsx)(N.a.Item,{label:this.m("description"),name:"description",children:Object(P.jsx)(y.a,{})}),Object(P.jsx)(N.a.Item,{label:this.m("data"),name:"data",children:Object(P.jsx)(C,{rows:6})}),Object(P.jsx)(N.a.Item,{label:this.m("type"),name:"type",children:Object(P.jsx)(y.a,{})}),Object(P.jsx)(N.a.Item,{children:Object(P.jsx)(l.a,{loading:e,type:"primary",htmlType:"submit",children:n.formatMessage({id:"save"})})})]})},i)})})}}I.contextType=u.a;var M=Object(o.i)(Object(r.c)(I)),w=s(636);class D extends i.a.Component{constructor(e){super(e),this.pendingStart=()=>{this.props.onPendingStart?this.props.onPendingStart():this.setState({pending:!0})},this.pendingEnd=()=>{this.props.onPendingEnd?this.props.onPendingEnd():this.setState({pending:!1})},this.setParams=()=>{const{param1:e,param2:t}=this.props.match.params;this.setState({itemId:e,mode:t})},this.loadTree=async()=>{this.setState({pending:!0});let e=[];this.state.treeSearch&&(e.push({lstr:"(",field:"name",compare:"IKE",value:"%".concat(this.state.treeSearch,"%")}),e.push({condition:"OR",field:"description",compare:"IKE",value:"%".concat(this.state.treeSearch,"%"),rstr:")"}));let t=await this.context.api.q("/resource/list",{search:e},{toTree:!0,parentKey:"node"});this.setState({tree:t,treeKey:Object(n.a)(),pending:!1})},this.onTreeSelect=e=>{Array.isArray(e)&&e[0]&&this.props.history.push("/admin/resource/".concat(e[0],"/"))},this.onTreeSearch=e=>{this.setState({treeSearch:e},()=>this.loadTree())},this.onAddStart=()=>{const{itemId:e}=this.state;e?this.props.history.push("/admin/resource/".concat(e,"/add")):this.props.history.push("/admin/resource/add")},this.onDelete=async()=>{const{intl:e,history:t}=this.props,{itemId:s}=this.state;this.pendingStart(),!1!==await this.context.api.q("/resource/delete",{id:s})?(c.b.success(e.formatMessage({id:"delete.success"})),t.push("/admin/resource/"),this.loadTree()):(c.b.error(e.formatMessage({id:"delete.fail"})),this.pendingEnd())},this.m=e=>{const{intl:t}=this.props;return t.formatMessage({id:"admin.resource."+e})},this.state={treeSearch:"",treeKey:Object(n.a)(),tree:[],itemId:null,mode:null}}componentDidMount(){this.setParams(),this.loadTree()}componentDidUpdate(e,t,s){Object(b.a)(e,this.props)&&this.setParams(),e.intl.locale!==this.props.intl.locale&&this.loadTree()}render(){const{intl:e}=this.props,{pending:t,treeKey:s,itemId:a,mode:i}=this.state;return Object(P.jsxs)(P.Fragment,{children:[Object(P.jsx)(w.a,{title:this.m("resource"),url:"/admin/resource",icon:Object(P.jsx)(x.a,{})}),Object(P.jsxs)(j.a,{pending:t,onSearch:this.onTreeSearch,children:[Object(P.jsx)("div",{}),Object(P.jsx)("div",{className:"isoNoteBtns",children:Object(P.jsxs)(h.b,{children:[Object(P.jsx)(d.a,{title:this.m("btn.add"),children:Object(P.jsx)(l.a,{onClick:this.onAddStart,type:"primary",icon:Object(P.jsx)(g.a,{})})}),Object(P.jsx)(p.a,{title:"".concat(e.formatMessage({id:"delete.sure"})),onConfirm:()=>this.onDelete(),okText:e.formatMessage({id:"yes"}),cancelText:e.formatMessage({id:"no"}),children:Object(P.jsx)(d.a,{title:this.m("btn.delete"),children:Object(P.jsx)(l.a,{icon:Object(P.jsx)(O.a,{})})})})]})}),Object(P.jsx)(m.a,{defaultExpandParent:!0,defaultSelectedKeys:[a],defaultExpandedKeys:[a],treeData:this.state.tree,onSelect:this.onTreeSelect},s),Object(P.jsx)("div",{children:a&&Object(P.jsx)(P.Fragment,{children:Object(P.jsx)(M,{itemId:"add"!==i?a:"add",nodeId:a&&"add"!==a?a:null,onChange:this.loadTree,onPendingStart:this.pendingStart,onPendingEnd:this.pendingEnd})})})]})]})}}D.contextType=u.a;t.default=Object(o.i)(Object(r.c)(D))},627:function(e,t,s){"use strict";function a(){return"f".concat((+new Date).toString(16)).concat((e=1e3,t=9999,e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e+1))+e));var e,t}s.d(t,"a",function(){return a})},636:function(e,t,s){"use strict";s.d(t,"a",function(){return o});var a=s(764),i=(s(0),s(102)),n=s(22),r=s(3);function o(e){return Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)(i.a,{children:Object(r.jsx)("title",{children:e.title})}),Object(r.jsx)("h2",{className:"title gx-mb-4",children:Object(r.jsx)(n.a,{to:e.url,className:"gx-text-dark",children:Object(r.jsxs)(a.b,{children:[e.icon,e.title]})})})]})}},638:function(e,t,s){"use strict";function a(e,t){const s=e.match.params||{},a=t.match.params||{};return s.param1!==a.param1||s.param2!==a.param2||s.param3!==a.param3}s.d(t,"a",function(){return a})},647:function(e,t,s){"use strict";var a=s(0),i=s.n(a),n=s(595),r=s(172),o=s(3);let c=null;class h extends i.a.Component{constructor(e){super(e),this.searchHandle=e=>{this.setState({searchValue:e}),this.state.searchDelay||!this.props.onSearch?(this.setState({searchPending:!0}),window.clearTimeout(c),c=window.setTimeout(()=>{this.setState({searchPending:!1}),this.props.onSearch&&this.props.onSearch(e)},this.state.searchDelay)):this.props.onSearch(e)},this.searchOnChange=e=>{this.searchHandle(e.target.value)},this.state={searchValue:e.defaultValue||"",searchPending:!1,searchDelay:e.hasOwnProperty("searchDelay")?e.searchDelay:1e3}}render(){const{intl:e,className:t}=this.props,{searchValue:s,searchPending:a}=this.state;let i=this.props.placeholder||e.formatMessage({id:"search.placeholder"});return Object(o.jsx)(n.a.Search,{placeholder:i,className:t,value:s,onChange:this.searchOnChange,onSearch:()=>this.searchHandle(s),loading:a})}}t.a=Object(r.c)(h)},652:function(e,t,s){"use strict";var a=s(0),i=s.n(a),n=s(126),r=s(260),o=s(3);var c=e=>{let{id:t,style:s,children:a,className:i}=e;return Object(o.jsx)(r.Scrollbars,{id:t,className:i,style:s,autoHide:!0,autoHideTimeout:1e3,autoHideDuration:200,autoHeightMin:0,autoHeightMax:200,thumbMinSize:30,universal:!0,children:a})},h=s(647),d=s(596),l=s(693),p=s(172);const{Header:m,Content:j}=d.a;class u extends i.a.Component{render(){const[e,t,s,a]=this.props.children;return Object(o.jsx)(o.Fragment,{children:Object(o.jsx)(l.a,{spinning:!!this.props.pending,children:Object(o.jsxs)("div",{className:"isomorphicNoteComponent",children:[Object(o.jsx)("div",{style:{width:"340px"},className:"isoNoteListSidebar",children:Object(o.jsxs)("div",{className:"isoNoteListWrapper",children:[this.props.onSearch&&Object(o.jsx)(h.a,{placeholder:this.props.searchPlaceholder,className:"isoSearchNotes",onSearch:this.props.onSearch,searchDelay:this.props.searchDelay}),Object(o.jsx)("div",{className:"isoNoteList",children:s?Object(o.jsx)(c,{children:Object(o.jsx)("div",{className:"isoNoteListHolder",children:s})}):Object(o.jsx)("span",{className:"isoNoResultMsg",children:Object(o.jsx)(n.a,{id:"nothing.found"})})})]})}),Object(o.jsxs)(d.a,{className:"isoNotepadWrapper",children:[Object(o.jsxs)(m,{className:"isoHeader",children:[e,t]}),Object(o.jsx)(j,{className:"isoNoteEditingArea",children:a&&Object(o.jsx)(c,{children:Object(o.jsx)("div",{className:"isoNoteContentHolder",children:a})})})]})]})})})}}t.a=Object(p.c)(u)},761:function(e,t,s){"use strict";var a=s(0),i=s.n(a),n=s(172),r=s(1093),o=s(100),c=s(3);class h extends i.a.Component{constructor(e){super(e),this.load=async()=>{if(this.props.items)this.setState({items:this.props.items});else if(this.props.query){this.setState({pending:!0});let e=[];this.state.searchText&&this.props.async&&e.push({field:this.props.labelKey||"label",compare:"IKE",value:"%".concat(this.state.searchText,"%")});let t=await this.context.api.q(this.props.query,{search:e},{toTree:!0,parentKey:this.props.parentKey});this.setState({pending:!1,items:t})}},this.onSearch=async e=>{this.props.async&&this.setState({searchText:e},()=>this.load())},this.state={searchText:"",pending:!1,items:[]}}componentDidMount(){this.load()}render(){return Object(c.jsx)(r.a,{allowClear:this.props.allowClear,loading:!!this.state.pending,value:this.state.pending?null:this.props.value,treeDefaultExpandAll:this.props.treeDefaultExpandAll,showSearch:!0,placeholder:this.props.placeholder,treeNodeFilterProp:"children",onChange:this.props.onChange,onSearch:this.onSearch,treeData:this.state.items,filterTreeNode:(e,t)=>t.title.toLowerCase().indexOf(e.toLowerCase())>=0})}}h.contextType=o.a,t.a=Object(n.c)(h)}}]);
//# sourceMappingURL=35.22ce8be1.chunk.js.map